\documentclass[12pt,twoside,a4]{mwbk}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% polonizacja
%\usepackage[polish]{babel} 
\usepackage[T1]{fontenc} 
\usepackage[cp1250]{inputenc}
\usepackage{polski}
\usepackage{enumerate}
\usepackage{graphicx} 
\usepackage{hyperref}
\usepackage{float}
\usepackage{siunitx}


%%MATLAB%%
\usepackage{listings}
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}

\lstset{language=Matlab,%
    %basicstyle=\color{red},
    breaklines=true,%
    morekeywords={matlab2tikz},
    keywordstyle=\color{blue},%
    morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
    identifierstyle=\color{black},%
    stringstyle=\color{mylilas},
    commentstyle=\color{mygreen},%
    showstringspaces=false,%without this there will be a symbol in the places where there is a space
    numbers=left,%
    numberstyle={\tiny \color{black}},% size of the numbers
    numbersep=9pt, % this defines how far the numbers are from the text
    emph=[1]{for,end,break},emphstyle=[1]\color{red}, %some words to emphasise
    %emph=[2]{word1,word2}, emphstyle=[2]{style},    
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%przerwa miêdzy liniami
\linespread{1.3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% deklaracja sposobu wyœwietlania rozdzia³u
\DeclareSectioningCommand[breakbefore]{chapter}{1}
{24pt plus5pt minus2pt}
{\LARGE\textbf{\ifHeadingNumbered\HeadingNumber.\enspace\fi\HeadingText}}
{10pt plus3pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% zmiana wyœwietlania spis treœci
\usepackage{tocloft}
\renewcommand\cftchapfont{\normalfont}
\renewcommand{\cftchapleader}{\cftdotfill{\cftsecdotsep}}
\renewcommand\cftchappagefont{\normalfont}
\renewcommand{\cftdotsep}{0.2}
\renewcommand\cftchapdotsep{\cftdot}
\setlength{\cftbeforechapskip}{0pt}
\renewcommand{\chaptername}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% sposób wyœwietlania numerów: wzorów, rysunków, tabel
\renewcommand{\thetable}{\thechapter.\arabic{table}}  
\renewcommand{\thefigure}{\thechapter.\arabic{figure}} 
\renewcommand{\theequation}{\thechapter.\arabic{equation}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% za³¹czanie grafi
%% proszê umieszczaæ pliki w katalogu g³ównym dokumentu, 
%% proszê pamiêtaæ, ¿e logo te¿ powinno tam byæ
\usepackage{graphicx}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% marginesy
\usepackage[a4paper,top=2.5cm,foot=2cm,left=3.5cm,right=2.5cm]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pagina ¿ywa, a w³aœciwie jej brak
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[RO,LE]{\thepage~}
\fancyhead{}
\renewcommand{\headrulewidth}{0pt}%{}
\setlength{\footskip}{10mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% zmiana itemize na kropki
\usepackage{enumitem}
\setitemize[1]{label=$\bullet$}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pakiety ,,matematyczne''  
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Twierdzenia, definicje, i inne
\newtheorem{twierdzenie}{Twierdzenie}[chapter]
\theoremstyle{definition}
\newtheorem{definicja}{Definicja}[chapter]
\newtheorem{stwierdzenie}{Stwierdzenie}[chapter]
\newtheorem{lemat}{Lemat}[chapter]
\newtheorem{wniosek}{Wniosek}[chapter]
\newtheorem{przyklad}{Przyk³ad}[chapter]
\newtheorem{uwaga}{Uwaga}[chapter]
\newtheorem{fakt}{Fakt}[chapter]
\newtheorem{propozycje}{Propozycje}[chapter]
\newenvironment{dowod}[1][Dowód]{\noindent\textbf{#1.} }{\newline\smallskip \hfill \rule{0.5em}{0.5em}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% brak numeracji strony na pierwszej stronie rozdzia³u
\usepackage{nopageno}


\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%strona tytu³owa
\renewcommand{\maketitle}{
\begin{titlepage}
  \begin{center}
    {\Large \bf POLITECHNIKA POZNAÑSKA}\\
    \vspace{0.15in}
    {\large \bf WYDZIA£ ELEKTRYCZNY}\\
    \vspace{0.15in}
    {\large \bf Instytut Matematyki}\\
    \vspace{0.3in}
    
    %Logo 
    \begin{figure}[h]
    \centering
    \includegraphics[height=1.5in]{logoPP.jpg}
    \end{figure}

    \vspace{0.7in}
%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% odpowiednie s³owo wykasowaæ
    {\large PRACA DYPLOMOWA MAGISTERSKA}\\
    \vspace{0.15in}
    \textsc{\@title}
  \end{center}

 \begin{center}
   \vspace{0.8in}
   {\LARGE \centering \@author} \par
 \end{center}

 \begin{flushleft}
    \vspace{1.2in}
     \hspace{4in}{Promotor:}\\
%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% wpisaæ nazwisko promotora
     \hspace{4in}{dr hab. Ma³gorzata Migda}\\
  \end{flushleft}
    \vspace*{\stretch{1}}
    \begin{center}
    POZNAÑ, 2018 
    \end{center}
\end{titlepage}}

\makeatother
%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% wpisaæ swoje nazwisko
\author{Ma³gorzata Lipiñska}

%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% wpisaæ tytu³
\title{{\Large \bf TESTY PIERWSZOŒCI LICZB I ICH ZASTOSOWANIA W KRYPTOGRAFII\\ \vspace{0.15in} }}

%koniec strony tytu³owej

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pocz¹tek dokumentu
\begin{document}

\pagestyle{empty}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pierwsza strona - strona tytu³awa
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% druga strona - pusta strona
\newpage
\mbox{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% trecia strona
\newpage
\thispagestyle{empty}
    \vspace*{1cm}
   \begin{center} 
   {\Large \bf KARTA PRACY DYPLOMOWEJ Z DZIEKANATU\\
   (kserokopia z podpisami)}
   \end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% czwarta strona - pusta strona
\newpage
\mbox{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Podziekowania
\newpage
\vspace*{\stretch{1}}

\hspace{7cm}
\begin{minipage}{7cm}
{\Large Podziêkowania}
\vspace{5mm}

%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% chyba zmieniæ podziêkowania ;-)

Sk³adam serdecznie podziêkowania

\quad moim rodzicom,

\end{minipage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pusta strona
\newpage
\mbox{ }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% spis treœci
\newpage
\pagestyle{fancy}
\tableofcontents


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%
%%%%%%%%
%%%%%%%%      W S T Ê P
%%%%%%%%
%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{Wstêp}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%
%%%%%%%%
%%%%%%%%    P I E R W S Z Y    R O Z D Z I A £
%%%%%%%%
%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Liczby pierwsze}
Poni¿szy rozdzia³ jest zbiorem wszystkich najwa¿niejszych pojêæ i twierdzeñ zwi¹zanych z liczbami pierwszymi oraz ich w³asnoœciami.

\section{Zasadnicze twierdzenie arytmetyki i twierdzenie Euklidesa}
Jednym z najwa¿niejszymi twierdzeñ dotycz¹cych liczb pierwszych jest zasadnicze twierdzenie arytmetyki. Jego wprowadzenie i~udowodnienie wymaga zdefiniowania kilku podstawowych pojêæ z zakresu teorii liczb, które zostan¹ omówione w tym podrozdziale.
 
\begin{definicja}
\textit{Liczb¹ pierwsz¹} nazywa siê liczbê naturaln¹ wiêksz¹ od 1, która ma dok³adnie dwa dzielniki: jedynkê i sam¹ siebie. 
\end{definicja}

Zbiór wszystkich liczb pierwszych oznacza siê liter¹ $\mathbb{P}$.
Liczb¹ z³o¿on¹ jest wiêc liczba, która ma wiêcej ni¿ dwa dzielniki. Warto zauwa¿yæ, ¿e 1 nie jest liczb¹ ani pierwsz¹, ani z³o¿on¹.

\begin{definicja} \cite[\mbox{s.} 3]{marzant}
\textit{Liczba ca³kowita $b$ jest podzielna przez liczbê ca³kowit¹ $a$}, jeœli istnieje taka liczba ca³kowita $e$, ¿e zachodzi $b = ae$. Wtedy liczba $a$ jest dzielnikiem liczby $b$, z kolei o liczbie $b$ mówi siê, ¿e jest wielokrotnoœci¹ $a$.
\end{definicja}

Jeœli liczba $b$ jest podzielna przez $a$ ($a$ dzieli $b$), to u¿ywa siê oznaczenia $a \mid b$, natomiast w przeciwnym przypadku stosuje siê oznaczenie $a \nmid b$.

\begin{definicja}
\textit{Najmniejsza wspólna wielokrotnoœæ} dla zadanych liczb ca³kowitych to najmniejsza liczba naturalna, któr¹ dzieli siê bez reszty przez ka¿d¹ z tych liczb. 
\end{definicja}

Najmniejsz¹ wspóln¹ wielokrotnoœæ liczb $a$ i $b$ oznacza siê symbolem $NWW(a,b)$, np. $NWW(2, 15) = 30$.

\begin{definicja}
\textit{Najwiêkszy wspólny dzielnik} dla zadanych dwóch lub wiêcej liczb ca³kowitych to najwiêksza liczba naturalna, która dzieli ka¿d¹ z tych liczb.
\end{definicja}

Najwiêkszy wspólny dzielnik liczb $a$ i $b$ oznaczany jest symbolem $NWD(a,b)$, np. $NWD(18, 15) = 3$.

\begin{definicja}
\textit{Liczby wzglêdnie pierwsze} to liczby ca³kowite, których najwiêkszym wspólnym dzielnikiem jest liczba $1$.
\end{definicja}

Jeœli dwie liczby $a$ i $b$ s¹ wzglêdnie pierwsze to zapisuje siê to jako $NWD(a,b)=1$ lub $(a,b)=1$.

\begin{lemat}(Euklides) \cite[\mbox{s.} 10]{zakrzew}
\label{Euklideslemat}
Jeœli liczba pierwsza $p$ dzieli iloczyn $ab$, to dzieli przynajmniej jeden z tych czynników. Inaczej, jeœli $p \in \mathbb{P}$ oraz $p \mid ab$, to $p \mid a$ lub $p \mid b$.
\end{lemat}

\begin{dowod}
Przyjmijmy, ¿e $p \nmid a$, czyli $NWD(a,p) = 1$, gdy¿ $p \in \mathbb{P}$. Wtedy $p \mid b$.
\end{dowod}

\begin{lemat} \cite[\mbox{s.} 9]{marzant}
\label{dzieleniek}
Je¿eli $p \in \mathbb{P}$ i $p \mid a_{1} \cdot ... \cdot a_{n}$, to istnieje $k$ ($1 \leq k \leq n$), takie ¿e $p \mid a_{k}$.
\end{lemat}

\begin{dowod}
Dowód wynika wprost z dowodu Lematu \ref{Euklideslemat}. Iloczyn $a_{1} \cdot ... \cdot a_{n}$ mo¿na przedstawiæ w postaci $(a_{1} \cdot ... \cdot a_{n-1})a_{n}$. Wtedy $p \mid (a_{1} \cdot ... \cdot a_{n-1})a_{n}$, czyli z poprzedniego dowodu $p \mid a_{1} \cdot ... \cdot a_{n-1}$ lub $p \mid a_{n}$.
Zasadê t¹ mo¿na uogólniæ dla dowolnego $k$ ($1 \leq k \leq n$). Wtedy $p \mid a_{k} \cdot \prod_{i \neq k}^{n} a_{i}$, a wiêc $p \mid \prod_{i \neq k}^{n} a_{i}$ lub $p \mid a_{k}$.
\end{dowod}

\begin{lemat} \cite[\mbox{s.} 9]{marzant}
\label{dzieleniekpierwsza}
Jeœli liczby $p, q_{1},...,q_{n} \in \mathbb{P}$ oraz $p \mid q_{1} \cdot ... \cdot q_{n}$, to $p = q_{k}$ dla pewnego $k$, gdzie $1 \leqslant k \leqslant n$.
\end{lemat}

\begin{dowod}
Z Lematu \ref{dzieleniek} wiadomo, ¿e istnieje takie $k$, ¿e $p \mid q_{k}$, ale $q_{k} \in \mathbb{P}$ oraz $p > 1$, sk¹d wynika, ¿e $p = q_{k}$.
\end{dowod}

Trzy powy¿sze lematy to lematy pomocnicze, które pos³u¿¹ do udowodnienia zasadniczego twierdzenia arytmetyki, mówi¹cego o tym, ¿e liczby pierwsze s¹ czynnikami, na które mo¿na roz³o¿yæ wszystkie z³o¿one liczby naturalne. 

\begin{twierdzenie}(Zasadnicze twierdzenie arytmetyki) \cite[\mbox{s.} 10]{marzant}
\label{zta}
Ka¿d¹ liczbê naturaln¹ wiêksz¹ od 1, która nie jest liczb¹ pierwsz¹, mo¿na jednoznacznie przedstawiæ w postaci iloczynu liczb pierwszych.
\end{twierdzenie}

\begin{dowod}
Dowód powy¿szego twierdzenia nale¿y podzieliæ na dwie czêœci. Pierwsza dotyczyæ bêdzie istnienia rozk³adu, a druga jego jednoznacznoœci.

\textbf{Istnienie rozk³adu.}
Za³ó¿my, ¿e liczba $n$ jest liczb¹ z³o¿on¹. Wtedy 
$$D = \{d \in N, 1 < d < n, d \mid n\}$$ 
jest niepustym zbiorem dzielników liczby $n$. Niech $p_{1}$ bêdzie najmniejsz¹ liczb¹ zawart¹ w tym zbiorze. Zatem $p_{1}$ jest liczb¹ pierwsz¹, gdy¿ w przeciwnym przypadku istnia³oby $q < p_{1}$ takie, ¿e $q > 1$ i $q \mid p_{1}$, co by³oby sprzeczne z wyborem $p_{1}$. St¹d wynika, ¿e
$$n = p_{1} \cdot n_{1},$$
gdzie $1 < n_{1} < n$. Je¿eli liczba $n_{1} \in \mathbb{P}$, to ¿¹dany rozk³ad zosta³ osi¹gniêty, w~ przeciwnym wypadku rozumowanie nale¿y powtórzyæ dla $n_{1}$, sk¹d dostajemy
$$n = p_{1} \cdot p_{2} \cdot n_{1},$$
gdzie $1 < n_{2} < n_{1}$, $p_{1}, p_{2} \in \mathbb{P}$. Na koniec uzyskuje siê rozk³ad
$$n = p_{1} \cdot ... \cdot p_{k},$$
poniewa¿ $n_{1} > n_{2} > ... > 1$ jest malej¹cym ci¹giem liczb naturalnych, czyli jest ci¹giem skoñczonym.

\textbf{Jednoznacznoœæ rozk³adu.}
Za³ó¿my przeciwnie, ¿e rozk³ad nie jest jednoznaczny, czyli $n = p_{1} \cdot ... \cdot p_{r} = q_{1} \cdot ... \cdot q_{s}$, $(r \leqslant s)$, gdzie $p_{i}$ i $q_{j}$ dla $i=1,2,...,r$ i~ $j=1,2,...,s$ s¹ pierwsze i uporz¹dkowane niemalej¹co.
Poniewa¿ $p_{1} \mid q_{1}...q_{s}$, zatem z Lematu \ref{dzieleniekpierwsza} wynika, ¿e $p_{1}=q_{k}$ dla pewnego $k$, gdzie $1 \leqslant k \leqslant s$, sk¹d wynika, ¿e $p_{1} \geqslant q_{1}$. Analogicznie $q_{1} \mid p_{1}...p_{r}$, wiêc  $q_{1} \geqslant p_{1}$, czyli $p_{1} = q_{1}$. Dziel¹c pocz¹tkow¹ równoœæ przez $p_{1} = q_{1}$ i powtarzaj¹c to samo rozumowanie dla kolejnych czynników obu rozk³adów, otrzymujemy
$$1=q_{r+l} \cdot ... \cdot q_{s},$$
jeœli $r < s$. Jest to sprzeczne dla $q_{r+l},...,q_{s} \in \mathbb{P}$, a wiêc $r = s$ oraz $p_{i} = q_{i}$ dla ka¿dego $i=1,2,...,r$, czyli rozk³ad jest jednoznaczny. 
\end{dowod}

Z Zasadniczego Twierdzenia Arytmetyki \ref{zta} wynika bezpoœrednio poni¿szy wniosek.

\begin{wniosek} \cite[\mbox{s.} 10]{marzant}
Ka¿da liczba naturalna $n > l$ mo¿e byæ jednoznacznie zapisana w postaci kanonicznej 
$$n = p_{1}^{\alpha_{1}} \cdot p_{2}^{\alpha_{2}} \cdot ... \cdot p_{r}^{\alpha_{r}},$$ 
gdzie $p_{i} \in \mathbb{P}$, $\alpha_{i} \in \mathbb{N}$ dla ka¿dego $i=1,2,...,r$ oraz $p_{1} < p_{2} < ... < p_{r}$.
\end{wniosek}

Do obliczania $NWW$ i $NWD$ stosuje siê najczêœciej rozk³ad badanych liczb na iloczyn liczb pierwszych. 

\begin{przyklad} Obliczyæ $NWW$ i $NWD$ liczb $123$ i $567$.\\
Rozk³ad danych liczb na czynniki pierwsze:
\begin{align*}
123 &= 3 \cdot 41,\\
567 &= 3 \cdot 3 \cdot 3 \cdot 3 \cdot 7.
\end{align*}
Aby obliczyæ $NWW(a,b)$ nale¿y pomno¿yæ wszystkie czynniki pierwsze liczby $a$ i~czynniki pierwsze liczby $b$, które siê nie powtarzaj¹ przy rozk³adzie $a$.
$$NWW(123,567) = 3 \cdot 41 \cdot 3 \cdot 3 \cdot 3 \cdot 7 = 3^{4} \cdot 7 \cdot 41 = 23247.$$
$NWD(a,b)$ to iloczyn czynników pierwszych, które powtarzaj¹ siê w rozk³adzie liczby $a$ i~$b$.
$$NWS(123,567) = 3.$$
\end{przyklad}

\begin{wniosek} \cite[\mbox{s.} 8]{zakrzew}
$$NWD(a,b) \cdot NWW(a,b) = ab.$$
\end{wniosek}

\begin{dowod}
Niech 
\begin{align*}
a &= p_{1}^{\alpha_{1}} \cdot p_{2}^{\alpha_{2}} \cdot ... \cdot p_{n}^{\alpha_{n}},\\
b &= p_{1}^{\beta_{1}} \cdot p_{2}^{\beta_{2}} \cdot ... \cdot p_{n}^{\beta_{n}},
\end{align*}
bêd¹ rozk³adami liczb $a$ i $b$ na czynniki pierwsze. Wówczas
\begin{align*}
NWD(a,b) &= p_{1}^{min (\alpha_{1}, \beta_{1})} \cdot p_{2}^{min (\alpha_{2}, \beta_{2})} \cdot ... \cdot p_{n}^{min (\alpha_{n}, \beta_{n})},\\
NWW(a,b) &= p_{1}^{max (\alpha_{1}, \beta_{1})} \cdot p_{2}^{max (\alpha_{2}, \beta_{2})} \cdot ... \cdot p_{n}^{max (\alpha_{n}, \beta_{n})}.
\end{align*}
Po pomno¿eniu $NWD(a,b) \cdot NWW(a,b)$ otrzymano
\begin{align*}
&p_{1}^{min (\alpha_{1}, \beta_{1}) + max (\alpha_{1}, \beta_{1})} \cdot p_{2}^{min (\alpha_{2}, \beta_{2}) + max (\alpha_{2}, \beta_{2})} \cdot ... \cdot p_{n}^{min (\alpha_{n}, \beta_{n}) + max (\alpha_{n}, \beta_{n})} =\\
&= p_{1}^{\alpha_{1}+\beta_{1}} \cdot p_{2}^{\alpha_{2}+\beta_{2}} \cdot ... \cdot p_{n}^{\alpha_{n}+ \beta_{n}} =\\
&= p_{1}^{\alpha_{1}} \cdot p_{2}^{\alpha_{2}} \cdot ... \cdot p_{n}^{\alpha_{n}} \cdot p_{1}^{\beta_{1}} \cdot  p_{2}^{\beta_{2}} \cdot ... \cdot p_{n}^{\beta_{n}} = a \cdot b.
\end{align*}
\end{dowod}

\section{Twierdzenie i algorytm Euklidesa}
Euklides, ¿yj¹cy oko³o 300 roku p.n.e., to grecki matematyk pochodz¹cy z Aten, uczeñ Akademii Platoñskiej i wyk³adowca w s³ynnej Szkole Aleksandryjskiej. Zaliczany jest do grona najwiêkszych matematyków w historii, znany g³ównie jako twórca podstaw geometrii klasycznej. Jego najwiêkszym dzie³em s¹ \textit{Elementy}, które stanowi¹ jedn¹ z pierwszych prac teoretycznych z matematyki. Podrêcznik ten zawiera miêdzy innymi dwa klasyczne i bardzo wa¿ne pojêcia z zakresu teorii liczb - twierdzenie Euklidesa o liczbach pierwszych i algorytm pozwalaj¹cy znaleŸæ najwiêkszy wspólny dzielnik dwóch liczb naturalnych.  
 
\begin{twierdzenie}(Euklides)  \cite[\mbox{s.} 5]{zakrzew}
\label{euklides}
Istnieje nieskoñczenie wiele liczb pierwszych.
\end{twierdzenie}

Powsta³o kilkanaœcie dowodów twierdzenia \ref{euklides}. Poni¿ej przedstawiono pierwszy z nich, który zosta³ sformu³owany w IV wieku p.n.e. przez Euklidesa w \textit{Elementach}. 

\begin{dowod}
Za³ó¿my, ¿e istnieje skoñczony zbiór liczb pierwszych ponumerowanych kolejno $p_{1}, p_{2}, ..., p_{k}$. Rozwa¿my liczbê
$$n=p_{1} p_{2} ...p_{k}+1.$$
Z Twierdzenia \ref{zta} wynika, ¿e $n$ mo¿e byæ liczb¹ pierwsz¹ ró¿n¹ od wszystkich $p_{i}$ lub ma rozk³ad na czynniki pierwsze. Za³ó¿my, ¿e jednym z tych czynników jest $p$. Liczba $n$ przy dzieleniu przez ka¿de z $p_{i}$ daje resztê 1, wiêc $p$ jest ró¿ne od wszystkich $p_{i}$. Z tego wynika, ¿e albo $p$ jest pierwsze lub samo $n$ jest kolejn¹ liczb¹ pierwsz¹, wiêksz¹ od ka¿dego $p_{i}$, co jest sprzeczne z za³o¿eniem.
\end{dowod}

\begin{definicja}
\textit{Algorytm Euklidesa} to szybki sposób wyznaczania najwiêkszego wspólnego dzielnika dwóch liczb naturalnych.
\end{definicja}

Do zrozumienia dzia³ania powy¿szego algorytmu potrzebne bêdzie zdefiniowanie pojêcia reszty z dzielenia.

\begin{definicja} \cite[\mbox{s.} 8]{zakrzew}
Dla dowolnej liczby ca³kowitej $n$ i dowolnej liczby naturalnej $k$ istnieje tylko jedna para liczb ca³kowitych $q$ i $r$ taka, ¿e 
$$n=qk+r, \textnormal{ gdzie } 0 \leq r \leq k-1.$$
Liczbê $r$ nazywa siê wtedy \textit{reszt¹ z dzielenia}.
\end{definicja}

Zasadê dzia³ania algorytmu Euklidesa najlepiej wyjaœniæ przy pomocy przyk³adu.

\begin{przyklad} Za pomoc¹ algorytmu Euklidesa wyznaczyæ $NWD(1628, 374)$.\\
Dzia³anie algorytmu przebiega nastêpuj¹co:
\begin{align*}
1628 &= 4 \cdot 374 + 132\\
374 &= 2 \cdot 132 + 110\\
132 &= 1 \cdot 110 + 22\\
110 &= 5 \cdot 22 + 0.
\end{align*}
Ostatnia niezerowa reszta jest szukanym najwiêkszym wspólnym dzielnikiem badanych liczb. W przypadku powy¿szego przyk³adu $NWD(1628, 374)=22$.
\end{przyklad}

\begin{lemat}(Bézout) \cite[\mbox{s.} 9]{zakrzew}
\label{bezout}
Niech $NWD(a,b) = d$. Wówczas istniej¹ dwie liczby ca³kowite $k$ i $l$ takie, ¿e
$$d = ka + lb.$$
\end{lemat}

\begin{dowod}
Niech $a$ i $b$ bêd¹ niezerowymi liczbami ca³kowitymi, a $K$ oznacza zbiór wszystkich dodatnich liczb ca³kowitych postaci $am + bn$, gdzie $m, n \in \mathbb{Z}$. Zbiór $K$ jest niepusty, wiêc istnieje w nim element najmniejszy $d$, gdzie $d = ax + by$. Zgodnie z algorytmem dzielenia z reszt¹, istniej¹ takie liczby $q, r \in \mathbb{Z}$, dla których zachodzi $a = qd + r$, przy czym $0 \leq r < d$. Z drugiej strony
$$r = a - qd = a - q(ax+by) = a - aqx - bqy = a(1-qx) + b(-qy).$$
Je¿eli $0 < r < d$, to znaczy, ¿e $r \in K$, co jest sprzeczne ze stwierdzeniem, ¿e $d$ jest najmniejszym elementem w $K$. St¹d $r = 0$, a z tego wynika, ¿e $a = qd$, a to oznacza, ¿e $d | a$. Podobnie mo¿na wykazaæ, ¿e $d | b$, sk¹d wynika, ¿e $d$ jest wspólnym dzielnikiem dla $a$ i $b$. Jeœli $c$ jest innym wspólnym dzielnikiem liczb $a$ i $b$, to $c$ dzieli równie¿ $ax + by = d$ , co z definicji oznacza, ¿e $d = NWD(a,b)$.
\end{dowod}

\begin{wniosek}
Niech $a$ i $b$ s¹ wzglêdnie pierwsze, czyli $NWD(a,b) = 1$, to istniej¹ dwie liczby ca³kowite $k$ i $l$ takie, ¿e
$$ka + lb = 1.$$
\end{wniosek}

\section{Kongruencje i ich zastosowania}
W poni¿szym rozdziale zawarte zosta³y najwa¿niejsze informacje i twierdzenia zwi¹zane z kongruencj¹. Pojêcia te bêd¹ wykorzystywane w dalszej czêœci pracy.

\begin{definicja}  \cite[\mbox{s.} 41]{sierpinski}
Niech $n$ bêdzie dowoln¹ liczb¹ naturaln¹. Liczby ca³kowite $a$ i $b$ \textit{przystaj¹ modulo} $n$, je¿eli ich ró¿nica $a-b$ jest podzielna przez $n$. Symbolicznie zapisuje siê to jako
$$a \equiv b \  (mod \  n).$$
Relacjê t¹ nazywamy kongruencj¹ lub przystawaniem modulo.
\end{definicja}

Kongruencja jest relacj¹ równowa¿noœci. Jest ona
\renewcommand{\theenumi}{\Roman{enumi}}
\begin{enumerate}
\item Zwrotna, poniewa¿ ka¿da liczba przystaje sama do siebie
$$a \equiv a \ (mod \ n).$$

\begin{dowod}
Wystarczy zauwa¿yæ, ¿e $a-a=0$ jest podzielna przez ka¿de $n \in \mathbb{N}$.
\end{dowod}

\item Symetryczna, gdy¿ kongruencja 
$$a \equiv b \ (mod \ n) \Leftrightarrow b \equiv a \ (mod \ n).$$
\begin{dowod}
Je¿eli $a-b=kn$, gdzie $k \in \mathbb{Z}$, to $b-a=-kn$. St¹d wynika, ¿e $a \equiv b \ (mod \ n)$. 
\end{dowod}

\item Przechodnia, poniewa¿ zachodzi
$$(a \equiv b \ (mod \ n) \wedge b \equiv c \ (mod \ n)) \Rightarrow a \equiv c \ (mod \ n).$$
\begin{dowod}
Wiadomo, ¿e $a-b \equiv 0 \ (mod \ n)$ i $b-c \equiv 0 \ (mod \ n)$. Opieraj¹c siê na to¿samoœci $$a-c = (a-b)+(b-c)$$ otrzymujemy, ¿e $a-c \equiv 0 \ (mod \ n)$, sk¹d wynika, ¿e $a \equiv c \ (mod \ n)$.
\end{dowod}
\end{enumerate}

\begin{twierdzenie} \cite[\mbox{s.} 37]{narkiewicz}
\label{wlasnoscikongruencji}
Relacja kongruencji spe³nia nastêpuj¹ce w³asnoœci:
\begin{enumerate}[label=(\roman*)]
\item Je¿eli $a \equiv b \ (mod \ n)$ oraz $c \equiv d \ (mod \ n)$, to
$$a+c \equiv b+d \ (mod \ n),$$
$$a-c \equiv b-d \ (mod \ n),$$
$$ac \equiv bd \ (mod \ n).$$
\item Kongruencja $a \equiv b \ (mod \ n)$ zachodzi wtedy i tylko wtedy, gdy $n|(a-b)$.
\item Je¿eli $ab \equiv ac \ (mod \ n)$ i $(a, n) = 1$, to $b \equiv c \ (mod \ n)$.
\item Je¿eli $a \in \mathbb{N}$ i $ab \equiv ac \ (mod \ an)$, to $b \equiv c \ (mod \ n)$.
\item Je¿eli $a \equiv b \ (mod \ n)$ to $a^{k} \equiv b^{k} \ (mod \ n)$.
\end{enumerate}
\end{twierdzenie}

\begin{dowod}
(i) Wiemy, ¿e $a-b = hn$ i $c-d = gn$, gdzie $g, h \in \mathbb{Z}$. Z to¿samoœci
$$(a+c) - (b+d) = (a-b) + (c-d) = (h+g)n,$$
wynika, ¿e 
$$(a+c) - (b+d) \equiv 0 \  (mod \ n) \Rightarrow a+c \equiv b+d \  (mod \ n)$$
Podobnie dla odejmowania prawdziwa jest to¿samoœæ
$$(a-c) - (b-d) = (a-b) - (c-d) = (h-g)n,$$
sk¹d wynika, ¿e 
$$(a-c) - (b-d) \equiv 0 \  (mod \ n) \Rightarrow a-c \equiv b-d \  (mod \ n).$$
Opieraj¹c siê na to¿samoœci
$$ac - bd = (a-b)c + (c-d)b = hnc + gnb = (hc + gb)n,b$$
otrzymujemy, ¿e 
$$ac - bd = 0 \ (mod \ n) \Rightarrow ac = bd \ (mod \ n).$$

(ii) Je¿eli $a \equiv b \ (mod \ n)$ to $a-b \equiv 0 \ (mod \ n)$, wiêc $a-b = hn$, gdzie $h \in \mathbb{Z}$. Zachodzi $n|hn$, sk¹d wynika, ¿e $n|a-b$. Dowód implikacji w drug¹ stronê przebiega analogicznie.

(iii) Je¿eli $ab \equiv ac \ (mod \ n)$, to znaczy, ¿e $n|(b-c)a$. Za³o¿enie $(a, n) = 1$ oznacza, ¿e $n \nmid a$, wiêc $n | (b-c)$. St¹d wynika, ¿e $b \equiv c \ (mod \ n)$.

(iv) Je¿eli $ab \equiv ac \ (mod \ an)$, to $an | a(b-c)$, z czego wynika, ¿e $n | (b-c)$, wiêc $b \equiv c \ (mod \ n)$.

(v) Dowód indukcyjny. Dla $k=1$ kongruencja zachodzi. Za³ó¿my, ¿e teza jest spe³niona dla pewnego $k$. Mamy wiêc  $a \equiv b \ (mod \ n)$ oraz $a^{k} \equiv b^{k} \ (mod \ n)$. Wykorzystuj¹c w³asnoœæ (i) mno¿ymy przez siebie obie kongruencje, otrzymuj¹c
$$aa^{k} \equiv bb^{k} \ (mod \ n) \Rightarrow a^{k+1} \equiv b^{k+1} \ (mod \ n),$$
co koñczy dowód.
\end{dowod}

\begin{stwierdzenie} \cite[\mbox{s.} 30]{marzant}
Relacja kongruencji modulo $m$ jest relacj¹ równowa¿noœci w zbiorze liczb ca³kowitych $\mathbb{Z}$, a warstwy (klasy abstrakcji) tej relacji nazywamy klasami reszt modulo $m$.
\end{stwierdzenie}

Ka¿d¹ liczbê ca³kowit¹ $a$ mo¿na zapisaæ w postaci $a = qm + r$, gdzie $0 \leq r < m$, wiêc ka¿da liczba ca³kowita przystaje modulo $m$ do jednej z liczb ze zbioru $\{0, 1, ... , m-1\}$. ¯adne dwie liczby spoœród liczb $0$,$1$, ... , $m-1$ nie przystaj¹ do siebie modulo $m$, wiêc zbiór postaci $\{0, 1, ... , m-1\}$ tworzy pe³ny uk³ad reprezentantów warstw.

\begin{definicja} \cite[\mbox{s.} 31-32]{marzant}
\textit{Pe³nym uk³adem reszt modulo $m$} nazywamy pe³ny uk³ad reprezentantów klas relacji przystawania modulo $m$.
\end{definicja}

\begin{definicja}
\textit{Zredukowanym uk³adem reszt modulo $m$} nazywamy uk³ad reprezentantów tych klas relacji przystawania modulo $m$, które sk³adaj¹ siê z liczb wzglêdnie pierwszych z modu³em $m$.
\end{definicja}

\begin{definicja} \cite[\mbox{s.} 31]{zakrzew}
\textit{Funkcj¹ $\varphi$ (Eulera)} lub tocjentem nazywamy funkcjê arytmetyczn¹, która ka¿dej liczbie naturalnej $m$ przypisuje liczbê elementów zredukowanego uk³adu reszt modulo $m$.
\end{definicja}

Mo¿na zauwa¿yæ, ¿e dla ka¿dej liczby naturalnej $m$ zbiór 
$$\phi(m) := \{k : 1 \leq k \leq m,(k,m) = 1 \}$$ 
tworzy zredukowany uk³ad reszt modulo m.

\begin{stwierdzenie} Funkcji Eulera ma nastêpuj¹ce w³asnoœci:
\label{wlasnoscifunkcjieulera}
\begin{enumerate}[label=(\arabic*)]
\item Dla ka¿dej liczby naturalnej $n>1$ zachodzi $\varphi(n) \leq n-1.$
\item Jeœli liczby naturalne $n$ i $m$ s¹ wzglêdnie pierwsze to $\varphi(nm) = \varphi(n)\varphi(m).$
\item Jeœli $p$ jest liczb¹ pierwsz¹ to $\varphi(p) = p-1.$
\item Jeœli $p$ jest liczb¹ pierwsz¹ to $\varphi(p^{k})=p^{k-1}(p-1)$.
\item Jeœli $p$ i $q$ s¹ ró¿nymi liczbami pierwszymi to $\varphi(pq)=(p-1)(q-1).$
\item Jeœli $p_{1}, p_{2},...,p_{k}$ s¹ wszystkimi czynnikami pierwszymi liczby $n$ bez powtórzeñ, to 
$$\varphi(n) = n \left(1-\frac{1}{p_{1}}\right)\left(1-\frac{1}{p_{2}}\right)...\left(1-\frac{1}{p_{k}}\right).$$
\end{enumerate}
\end{stwierdzenie}

\begin{przyklad} Obliczyæ $\varphi(9)$, $\varphi(12)$,  $\varphi(13)$.

Pe³nym uk³adem reszt modulo 9 jest zbiór $R = \{0,1,2,3,4,5,6,7,8\}$. Jeœli usuniemy z niego wszystkie liczby, które nie s¹ wzglêdnie pierwsze z 9, otrzymamy zbiór $R = \{1,2,4,5,7,8\}$. Liczba elementów zbioru $R$ jest równa 6, wiêc $\varphi(9) = 6$.

Pe³nym uk³adem reszt modulo 12 jest zbiór $R = \{0,1,2,3,4,5,6,7,8,9,10,11\}$. Usuwamy z niego wszystkie liczby, które nie s¹ wzglêdnie pierwsze z 12 i otrzymujemy zbiór $R = \{1,5,7,11\}$. Liczba elementów zbioru $R$ wynosi 4, wiêc $\varphi(12) = 4$.

Wartoœæ funkcji $\varphi$ dla liczby 13 mo¿na obliczyæ z w³asnoœci (3) stwierdzenia \ref{wlasnoscifunkcjieulera}:
$$\varphi(13) = 13 - 1 = 12.$$
\end{przyklad}

Funkcja Eulera jest bardzo prosta do zaimplementowania w œrodowisku Matlab (skrypt \ref{funkcjaEulera}). Poni¿ej przedstawiono tabelê z wynikami i czasem dzia³ania powy¿szej funkcji dla liczb o ró¿nej wielkoœci.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Wartoœæ funkcji $\varphi(n)$ &  Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline
1 & $23$ & $22$ & $0.023398$\\
\hline
2 & $100$ & $40$ & $0.029472$\\
\hline
3 & $567$ & $324$ & $0.047793$\\
\hline
4 & $1000$ & $400$ & $0.051363$\\
\hline
5 & $12345$ & $6576$ & $0.496064$\\
\hline
6 & $123456$ & $41088$ & $5.326313$\\
\hline
7 & $1234567$ & $1224720$ & $65.953887$\\
\hline
\end{tabular}
\caption{Wartoœæ funkcji $\varphi(n)$ dla liczb o ró¿nej wielkoœci.}
\end{center}
\end{table}

\begin{stwierdzenie}
Jeœli zbiór $\{a_{1},a_{2},...,a_{\varphi(m)}\}$ tworzy zredukowany uk³ad reszt modulo $m$ i $(k,m) = 1$, to zbiór $\{ka_{1},ka_{2},...,ka_{\varphi(m)}\}$ tak¿e tworzy zredukowany uk³ad reszt modulo $m$. 
\end{stwierdzenie}

\begin{definicja} \cite[\mbox{s.} 15]{zakrzew}
\textit{Odwrotnoœci¹ elementu} $a$ \textit{modulo} $n$ jest taki element, oznaczany przez $a^{-1}$, ¿e
$$aa^{-1} \equiv 1 \ mod \ n.$$
\end{definicja}

\begin{twierdzenie}
Liczba naturalna $a$ jest odwracalna modulo $n$ wtedy i tylko wtedy, gdy $a$ i $n$ s¹ wzglêdnie pierwsze.
\end{twierdzenie}

\begin{dowod}
Niech $(a,n)=1$. Wtedy na mocy lematu Bézouta \ref{bezout} dla pewnych $k$ i $l$ zachodzi $ka + ln = 1$. Korzystaj¹c z w³asnoœci (i) twierdzenia \ref{wlasnoscikongruencji} otrzymujemy
$$ka + ln = 1 \ (mod \ n),$$
sk¹d 
$$ka = 1 \ (mod \ n),$$
wiêc $k$ jest odwrotnoœci¹ elementu $a$ modulo $n$.

Implikacja w drug¹ stronê: Odwracalnoœæ elementu $a$ modulo $n$ oznacza, ¿e istnieje $k$, dla którego prawdziwa jest kongruencja $ka \equiv 1 \ (mod \ n)$. Wówczas $ka - 1 \equiv 0 \ (mod \ n)$, sk¹d wynika, ¿e 
$$ka - 1 = ln \Rightarrow ka + (-l)n = 1.$$
Z powy¿szej to¿samoœci wynika, ¿e $a$ i $n$ s¹ liczbami wzglêdnie pierwszymi.
\end{dowod}

\section{Sito Eratostenesa, Atkina i Sundarama}
Problem z liczbami pierwszymi polega na ich nieregularnym rozmieszczeniu poœród liczb naturalnych. Nie odkryto dot¹d ¿adnego wzoru pozwalaj¹cego na wyszukiwanie kolejnych liczb pierwszych, ale powsta³o kilka metod znajdowania takich liczb w zadanym przedziale. Metody te s¹ nazywane sitami, poniewa¿ aby znaleŸæ wszystkie liczby pierwsze mniejsze od liczby $n$ wystarczy ze zbioru liczb naturalnych mniejszych lub równych $n$ \textit{odsiaæ} liczby z³o¿one i jedynkê. Pierwszy s³u¿¹cy do tego algorytm zosta³ przedstawiony przez Eratostenesa z Cyreny (III-II w. p.n.e.). Sito to zosta³o póŸniej ulepszone przez Arthura Atkina i D.J. Bernsteina. Innym, mniej znanym sitem, jest sito Sundarama.

\begin{definicja} \cite[\mbox{s.} 55]{karbowski}
\label{sito}
\textit{Sito Eratostenesa} jest algorytmem wyszukiwania kolejnych liczb pierwszych z przedzia³u $\{2,n\}$. 
\end{definicja}

Algorytm polega na usuwaniu liczb z³o¿onych ze zbioru liczb naturalnych wiêkszych od $1$ i~mniejszych b¹dŸ równych $n$. Na pocz¹tek z zadanego zbioru wybieramy liczbê najmniejsz¹ i usuwamy wszystkie jej wielokrotnoœci z wyj¹tkiem jej samej. Nastêpnie wybieramy najmniejsz¹ liczbê z pozosta³ych i~znów usuwamy wielokrotnoœci tej liczby wiêksze od niej. Postêpujemy tak dopóki liczba, której wielokrotnoœci mamy usuwaæ, jest mniejsza ni¿ $\sqrt{n}$. Na koniec procesu w zbiorze pozostan¹ tylko liczby pierwsze. 

\begin{przyklad} Za pomoc¹ sita Eratostenesa wyznaczyæ wszystkie liczby pierwsze nale¿¹ce do zbioru $P=\{2,3,...,40\}$.

\renewcommand{\theenumi}{\Roman{enumi}}
\begin{enumerate}
\item Najmniejsz¹ liczb¹ w zbiorze $P$ jest $2$, wiêc usuwamy wszystkie wiêksze od $2$ wielokrotnoœci liczby $2$.
$$P=\{2,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39\}.$$
\item Kolejn¹ najmniejsz¹ liczb¹ w zbiorze (nie bior¹c pod uwagê liczby $2$) jest liczba $3$, wiêc usuwamy wszystkie jej wielokrotnoœci, przy czym nie usuwamy samej trójki.
$$P=\{2,3,5,7,11,13,17,19,23,25,29,31,35,37\}.$$
\item Nastêpn¹ najmniejsz¹ liczb¹ w zbiorze (nie bior¹c pod uwagê liczb $2$ i $3$) jest liczba $5$, wiêc wyrzucamy ze zbioru $P$ wszystkie jej wielokrotnoœci, zostawiaj¹c sam¹ $5$.
$$P=\{2,3,5,7,11,13,17,19,23,29,31,37\}.$$
\end{enumerate}
Krok trzeci jest ostatni, poniewa¿ w czwartym kroku najmniejsz¹ liczb¹, której wielokrotnoœci musielibyœmy usun¹æ, jest liczba $7$, ale $n = 40$, a $\sqrt{40} \approx 6.32$. Liczba $7$ jest wiêc wiêksza ni¿ $6.32$, mo¿emy zatem zatrzymaæ algorytm. Po trzecim kroku w zbiorze $P$ pozosta³y jedynie liczby pierwsze.
\end{przyklad}

Sito Eratostenesa mo¿na teoretycznie zapisaæ w postaci funkcji, na przyk³ad w programie Matlab (skrypt \ref{sitoEratostenesa}). Poni¿ej przedstawiona zosta³a tabela z wynikami dzia³ania algorytmu dla przedzia³ów o ró¿nej d³ugoœci.

\begin{table}[H] 
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & Koniec przedzia³u $\{2,n\}$ &  Czas dzia³ania programu $[s]$ & Liczba liczb pierwszych \\ [0.2ex] 
\hline \hline
1 & $\num{100}$ & 0.002345 & 25\\
\hline
2 & $\num{1000}$ & 0.00219 & 168\\
\hline
3 & $\num{10000}$ & 0.107349 & $\num{1229}$\\
\hline
4 & $\num{100000}$ & 0.191775 & $\num{9592}$\\
\hline
5 & $\num{1000000}$ & 0.253845 & $\num{78498}$\\
\hline
6 & $\num{10000000}$ & 6.684239 & $\num{664579}$\\
\hline
7 & $\num{100000000}$ & 174.164354 & $\num{5761455}$\\
\hline
\end{tabular}
\caption{Wyniki dzia³ania funkcji szukaj¹cej liczb pierwszych sitem Eratostenesa.}
\end{table}

Niestety w przypadku wiêkszego zakresu liczb czas oczekiwania na wynik jest bardzo d³ugi. Na przyk³ad przeszukiwanie zbioru liczb naturalnych $\{2, \num{1 000 000 000}\}$ mo¿e trwaæ ju¿ kilka godzin. Co wiêcej, najwiêksza znana obecnie liczba pierwsza jest o wiele wiêksza od liczb, które mo¿na znaleŸæ za pomoc¹ tego algorytmu nawet na nowoczesnych komputerach o du¿ej wydajnoœci.

\begin{definicja} \cite[\mbox{s.} 55-56]{karbowski}
\textit{Sito Atkina} lub \textit{sito Atkina-Bernsteina} to algorytm autorstwa dwóch matematyków - Arthura Atkina i D.J. Bernsteina, który s³u¿y do wyszukiwania liczb pierwszych w du¿ych przedzia³ach. 
\end{definicja}

Metoda ta dzia³a podobnie do sita Eratostenesa, jednak dziêki wykorzystaniu pewnych zale¿noœci jest efektywniejsza i~wymaga znacznie mniej pamiêci. Na przyk³ad algorytm ca³kowicie pomija wszystkie liczby podzielne przez 2, 3 lub 5, liczby z parzyst¹ reszt¹ z dzielenia przez 60, liczby, które maj¹ resztê z dzielenia przez 60 podzieln¹ przez 3 oraz liczby z reszt¹ z dzielenia przez 60 podzieln¹ przez 5. 
Pierwszoœæ pozosta³ych liczb rozpatrywana jest na podstawie ich reszty z dzielenia przez liczbê 12. Je¿eli wynosi ona:
\begin{itemize}
\item 1 lub 5 — liczba jest pierwsza, jeœli liczba rozwi¹zañ równania $4x^{2} + y^{2} = n$ (gdzie $n$ jest analizowan¹ przez nas liczb¹, a $x$ i $y$ to dowolne liczby naturalne) jest nieparzysta, a $n$ nie jest kwadratem innej liczby naturalnej,
\item 7 — liczba jest pierwsza, jeœli liczba rozwi¹zañ równania $3x^{2} + y^{2} = n$ (gdzie $n$ to analizowana przez nas liczba, a $x$ i $y$ to dowolne liczby naturalne) jest nieparzysta, a $n$ nie jest kwadratem innej liczby naturalnej,
\item 11 — liczba jest pierwsza, jeœli liczba rozwi¹zañ równania $3x^{2} – y^{2} = n$ (gdzie $n$ to analizowana przez nas liczba, a $x$ i $y$ to dowolne liczby naturalne i $x>y$) jest nieparzysta, a $n$ nie jest kwadratem innej liczby naturalnej.
\end{itemize}

\begin{definicja} \cite[\mbox{s.} 55]{karbowski}
\textit{Sito Sundarama} to prosty algorytm autorstwa XX-wiecznego indyjskiego matematyka Sundarama, który s³u¿y do wyszukiwania liczb pierwszych przedziale $\{1, n\}$. 
\end{definicja}
Algorytm przebiega w nastêpuj¹cy sposób:
\begin{enumerate}
\item Wybieramy przedzia³ $\{1,n\}$.
\item Z zadanego przedzia³u usuwamy liczby obliczone wzorem $l = i + j + 2ij$, gdzie $i,j \in \mathbb{N}$, $1 \leq i \leq j$ oraz $i + j + 2ij \leq n$.
\item Pozosta³e liczby ze zbioru mno¿ymy przez 2 i dodajemy 1.
\end{enumerate}
Po przeprowadzeniu algorytmu uzyskujemy listê liczb pierwszych z przedzia³u $\{3,2n+1\}$.

Sito Sundarama mo¿na zapisaæ w postaci funkcji, na przyk³ad w programie Matlab (skrypt \ref{sitoSundarama}). Poni¿sza tabela zawiera wyniki dzia³ania sita Sundarama dla przedzia³ów o ró¿nej d³ugoœci.

\begin{table}[H]
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & Koniec przedzia³u $\{1,n\}$ & Czas dzia³ania programu $[s]$ & Liczba liczb pierwszych \\
    & & & w przedziale $\{2,2n+1\}$ \\  [0.2ex] 
\hline \hline
1 & $\num{50}$ & 0.000764 & 26\\
\hline
2 & $\num{500}$ & 0.000663 & 168\\
\hline
3 & $\num{5000}$ & 0.001613 & $\num{1229}$\\
\hline
4 & $\num{50000}$ & 0.006975 & $\num{9592}$\\
\hline
5 & $\num{500000}$ & 0.055643 & $\num{78498}$\\
\hline
6 & $\num{5000000}$ & 0.639726 & $\num{664579}$\\
\hline
7 & $\num{50000000}$ & 7.374154 & $\num{5761455}$\\
\hline
8 & $\num{500000000}$ & 137.090207 & $\num{50847534}$\\
\hline
\end{tabular}
\caption{Wyniki dzia³ania funkcji szukaj¹cej liczb pierwszych sitem Sundarama.}
\end{table}

Jak ³atwo zauwa¿yæ, algorytm Sundarama jest o wiele szybszy ni¿ sito Eratostenesa.

\section{Spirala Ulama}
Stanis³aw Marcin Ulam (ur. 13 kwietnia 1909 we Lwowie, zm. 13 maja 1984 w~Santa Fe) to polski matematyk i~przedstawiciel lwowskiej szko³y matematycznej. W swoim dorobku ma wiele dokonañ w zakresie matematyki i~fizyki matematycznej oraz metod numerycznych. W 1963 roku zaprezentowa³ przedstawienie rozk³adu liczb pierwszych w formie graficznej, zwanej dziœ spiral¹ Ulama.

\begin{definicja} \cite{spiralaulama}
\textit{Spirala Ulama} lub \textit{spirala liczb pierwszych} to graficzna metoda przedstawiania rozk³adu liczb pierwszych. 
\end{definicja}

Sposób zapisu polega na tym, ¿e na kwadratowej tablicy zaczynaj¹c od 1 w œrodku spiralnie wypisuje siê kolejne liczby naturalne. Okazuje siê, ¿e na pewnych przek¹tnych liczby pierwsze pojawiaj¹ siê o wiele czêœciej ni¿ na innych. Co wiêcej, zjawisko nie zale¿y od wyboru pierwszej liczby w spirali. Na Rysunku \ref{ulam} przedstawiono spiralê Ulama o rozmiarze $400$x$400$.

\begin{figure}[H]
\label{ulam}
\begin{center}
\includegraphics[scale=0.75]{spirala_ulama.jpg}
\caption{Spirala Ulama o rozmiarze $400$x$400$ \cite{spiralaulama}.}
\end{center}
\end{figure}

\section{Twierdzenie Wilsona i ma³e twierdzenie Fermata}
Podrozdzia³ ten jest poœwiêcony dwóm klasycznym twierdzeniom z zakresu teorii liczb - twierdzeniu Wilsona i ma³emu twierdzeniu Fermata. Maj¹ one szerokie zastosowanie w testach pierwszoœci liczb.

\begin{twierdzenie}(Twierdzenie Wilsona, 1770 r.) \cite[\mbox{s.} 18]{zakrzew}
\label{wilson}
Liczba naturalna $p>1$ jest liczb¹ pierwsz¹ wtedy i tylko wtedy, gdy
$$(p-1)!+1 \equiv 0 \ mod \ p.$$
\end{twierdzenie}

Za odkrywcê powy¿szego twierdzenia uznaje siê Johna Wilsona, zosta³o jednak opublikowane przez Edwarda Waringa. Jak siê okazuje, wczeœniej mówi³ o nim ju¿ al-Hajsam (X/XI w.) i Leibniz (XVII w.). Pierwszy dowód twierdzenia Wilsona pochodzi od Lagrange'a i zosta³ przedstawiony w 1777 roku.

\begin{dowod}
Na pocz¹tek nale¿y pokazaæ, ¿e jeœli $p$ jest liczb¹ pierwsz¹, to zachodzi powy¿sza kongruencja. Dla $p=2$ implikacja jest spe³niona, wiêc ograniczono siê do liczb pierwszych nieparzystych.
Poniewa¿ $p$ jest liczb¹ pierwsz¹, wiêc ka¿da z liczb $1,2,3,...,p-2,p-1$ ma swoj¹ odwrotnoœæ modulo $p$. 
Poszukuje siê, dla jakich $a$ spoœród tych liczb zachodzi
$$a \equiv a^{-1} \ mod \ p,$$
tzn. 
$$a^{2} \equiv 1 \ mod \ p.$$
Ostatni warunek oznacza, ¿e liczba $p$ musi dzieliæ
$$a^{2}-1 = (a+1)(a-1).$$
Z Lematu \ref{Euklideslemat} (Euklidesa) wynika, ¿e $p$ dzieli $a+1$ lub $a-1$, wiêc $a=p-1$ lub $a=1$. Te dwie liczby na razie pominiêto. Wówczas liczby $2,3,...,p-2$ dziel¹ siê na pary, liczba i jej odwrotnoœæ modulo $p$, sk¹d wynika, ¿e
$$2 \cdot 3 \cdot ... \cdot (p-2) \equiv 1 \ mod \ p.$$
Mno¿¹c obie strony powy¿szej kongruencji przez $p-1$ otrzymano
$$(p-1)! \equiv p-1 \equiv -1 \ mod \ p,$$
co koñczy dowód pierwszej implikacji.

Teraz wystarczy pokazaæ implikacjê w drug¹ stronê. Nale¿y zatem udowodniæ, ¿e je¿eli $n$ jest liczb¹ z³o¿on¹ to zachodzi
$$(n-1)!+1 \not\equiv 0 \ mod \ n.$$
Jeœli $n$ jest liczb¹ z³o¿on¹, to zachodzi $n=pq$. Za³o¿ono, ¿e $p<q$. Wówczas
$$(n-1)!=1 \cdot 2 \cdot 3 \cdot ... \cdot (p-1) \cdot p \cdot ... \cdot (q-1) \cdot q \cdot ... \cdot (n-1),$$
wiêc $(n-1)!$ jest podzielne przez $n$. St¹d $(n-1)!+1$ nie mo¿e byæ podzielne przez $n$. Wynika st¹d, ¿e
$$(n-1)!+1 \not\equiv 0 \ mod \ n,$$
co koñczy dowód.
\end{dowod}

\begin{twierdzenie}(Eulera) \cite[\mbox{s.} 33]{marzant}
Je¿eli $n$ i $a$ s¹ wzglêdnie pierwszymi liczbami naturalnymi, to zachodzi
$$a^{\varphi(n)} \equiv 1 \ (mod \ n).$$
\end{twierdzenie}

\begin{dowod}
Niech uk³ad 
$$r_{1}, r_{2}, ..., r_{\varphi(n)}$$
bêdzie uk³adem reszt modulo $n$. Po pomno¿eniu ka¿dej z nich przez $a$ i podzieleniu przez $m$ powstaje nowy uk³ad reszt $r_{i}^{'}:$
$$r_{i}a=q_{i}n+r_{i}^{'}, \ i=1,2,...,\varphi(n).$$
Uk³ad mo¿na równie¿ przedstawiæ w postaci kongruencji
\begin{equation}
\label{twEulera1}
r_{i}a=r_{i}^{'} \ (mod \ n), \ i=1,2,...,\varphi(n).
\end{equation}
Po wymno¿eniu przez siebie wszystkich $\varphi(n)$ kongruencji \ref{twEulera1} otrzymano
$$a^{\varphi(n)}r_{1}r_{2}...r_{\varphi(n)} \equiv r_{1}^{'}r_{2}^{'}...r_{\varphi(n)}^{'} \ (mod \ n)$$
Zarówno $r_{i}$ i $r_{i}^{'}$ dla $i=1,2,...,\varphi(n)$ s¹ wzglêdnie pierwsze z $n$, wiêc obie strony mo¿na podzieliæ przez ich identyczny iloczyn, co daje 
$$a^{\varphi(n)} \equiv 1 \ (mod \ n).$$
\end{dowod}

\begin{twierdzenie}(Ma³e twierdzenie Fermata, 1640 r.) \cite[\mbox{s.} 19]{zakrzew}
\label{mtf}
Jeœli $p$ jest licz¹ pierwsz¹, to dla ka¿dej liczby ca³kowitej $a$ niepodzielnej przez $p$ zachodzi
$$a^{p-1} \equiv 1 \  (mod \  p).$$
\end{twierdzenie}

Twierdzenie to zosta³o odkryte jednoczeœnie przez Fermata i Leibniza. ¯aden z nich nie opublikowa³ jednak dowodu.

\begin{dowod}
Jeœli liczba pierwsza $p$ nie dzieli $a$, to ci¹g reszt z dzielenia $a$ przez $p$ $1,2,3,...,p-1$ oraz ci¹g liczb 
\begin{equation}
\label{ciag}
a,2a,3a,...,(p-1)a \ (mod \ p)
\end{equation}
ró¿ni¹ siê jedynie kolejnoœci¹.
£atwo zauwa¿yæ, ¿e jeœli $p$ nie dzieli $a$, to niemo¿liwe jest, aby $ka \equiv 0 \ (mod \ p)$ dla $k=1,2,...,p-1$. Z tego wynika, ¿e wszystkie reszty $ka \ mod \ p$ s¹ liczbami naturalnymi od $1$ do $p-1$. Poniewa¿ liczb tych jest dok³adnie $p-1$, wiêc nale¿y pokazaæ, ¿e s¹ one parami ró¿ne.

Za³o¿ono, ¿e dla $i,j<p$, gdzie $i \neq j$ zachodzi $ai \equiv aj \ (mod \ p)$. Z treœci twierdzenia wiadomo, ¿e $a$ nie jest podzielne przez $p$, wiêc obie strony mo¿na podzieliæ przez $a$, sk¹d otrzymano $i \equiv j \ (mod \ p)$. Obie liczby s¹ z za³o¿enia mniejsze od $p$, wiêc $i = j$, co prowadzi do sprzecznoœci.

Jak wczeœniej zauwa¿ono, ci¹g liczb \ref{ciag} modulo $p$ to ci¹g $1,2,...,p-1$, wiêc 
$$a \cdot 2a \cdot 3a \cdot ... \cdot (p-1)a \equiv 1 \cdot 2 \cdot 3 \cdot ... \cdot (p-1) \ (mod \ p),$$
a po przekszta³ceniu
$$(p-1)!a^{p-1} \equiv (p-1)! \ (mod \ p).$$
Z Twierdzenia \ref{wilson} wiadomo, ¿e liczba $(p-1)!$ jest wzglêdnie pierwsza z $p$, wiêc obie strony kongruencji mo¿na podzieliæ przez $(p-1)!$, co koñczy dowód.
\end{dowod}

\begin{definicja}
Je¿eli $n$ jest nieparzyst¹ liczb¹ z³o¿on¹, a liczba $b$, wzglêdnie pierwsza z $n$,  spe³nia warunek 
$$b^{n-1} \equiv 1 \ (mod \ n),$$ 
to $n$ jest \textit{liczb¹ pseudopierwsz¹} przy podstawie $b$.
\end{definicja}

Z twierdzenia Fermata \ref{mtf} wynika, ¿e dla ka¿dej liczby $a$, która jest wzglêdnie pierwsza z modu³em $n$, istnieje liczba naturalna $k$ taka, ¿e $a^{k} \equiv 1 \ (mod \ n)$. 

\begin{definicja} \cite{multord}
Rzêdem multiplikatywnym liczby ca³kowitej $a$ modulo $n$, gdzie $(a,n)=1$, nazywamy najmniejsz¹ liczbê naturaln¹ $k$, dla której zachodzi
$$a^{k} \equiv 1 \ (mod \ n).$$
\end{definicja}

Rz¹d elementu $a$ modulo $n$ oznacza siê $ord_{n}(a)$ lub $o_{n}(a)$. 

\begin{przyklad} Obliczyæ rz¹d multiplikatywny liczby 4 modulo 7.

Szukamy najmniejszej liczby $k \in \mathbb{N}$, dla której prawdziwa jest kongruencja 
$$4^{k} \equiv 1 \ (mod \ 7).$$
Sprawdzamy kongruencjê dla kolejnych wartoœci liczby $k$:
\begin{align*}
k = 1 &\Rightarrow 4^{1} = 4 \equiv 4 \ (mod \ 7) \neq 1 \ (mod \ 7), \\
k = 2 &\Rightarrow 4^{2} = 16 = 2 \cdot 7 + 2 \equiv 2 \ (mod \ 7) \neq 1 \ (mod \ 7), \\
k = 3 &\Rightarrow 4^{3} = 64 = 9 \cdot 7 +1 \equiv 1 \ (mod \ 7). \\
\end{align*}
Rzêdem multiplikatywnym liczby 4 modulo 7 jest 3.
\end{przyklad}

Obliczanie rzêdu elementu $a$ modulo $n$ jest równie¿ proste do zaimplementowania w œrodowisku Matlab (skrypt \ref{multorder}). Poni¿ej przedstawiono tabelê z wynikami i czasem dzia³ania powy¿szej funkcji.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & Liczba $n$ & Liczba $a$ & Wartoœæ funkcji $o_{n}(a)$ &  Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline
1 & $7$ & $4$ & $3$ & $0.033575$\\
\hline

2 & $4$ & $7$ & $2$ & $0.025657$\\
\hline

3 & $100$ & $387$ & $20$ & $0.031364$\\
\hline

4 & $167$ & $379$ & $166$ & $0.036658$\\
\hline

5 & $1000$ & $37$ & $100$ & $0.035297$\\
\hline
\end{tabular}
\caption{Wartoœæ funkcji  $o_{n}(a)$ dla liczb o ró¿nej wielkoœci.}
\end{center}
\end{table}


\section{W³asnoœci liczb pierwszych}
Liczby pierwsze mog¹ przyjmowaæ ró¿ne postaci. Podrozdzia³ ten skupia siê na ró¿nych rodzajach liczb pierwszych, takich jak liczby pierwsze Fermata, bliŸniacze, czworacze, Sophie Germain czy Mersenne'a. W czêœci tej przedstawione zostanie równie¿ zestawienie dziesiêciu najwiêkszych znanych liczb pierwszych na rok 2018.

\begin{twierdzenie} \cite[\mbox{s.} 46]{marzant}
Istnieje nieskoñczenie wiele liczb pierwszych postaci $4k-1$.
\end{twierdzenie}

\begin{dowod}
Przypuœæmy przeciwnie, ¿e $\{q_{1}, q_{2},..., q_{r}\}$ jest zbiorem wszystkich liczb pierwszych postaci $4k - 1$. Zdefiniujmy $N = 4q_{1}q_{2}...q_{r}-1.$

Poniewa¿ $N$ jest liczb¹ nieparzyst¹, wiêc wszystkie dzielniki liczby $N$ równie¿ s¹ nieparzyste. Z kolei ka¿da liczba nieparzysta ma postaæ $4k-1$ lub $4k+1$. Wiadomo tak¿e, ¿e iloczyn liczb postaci $4k+1$ jest te¿ liczb¹ postaci $4k+1$, wiêc $N$ musi mieæ dzielnik pierwszy $q$ postaci $4k-1$. Jak wiadomo, $q_{1} \nmid N$, $q_{2} \nmid N$, ..., $q_{r} \nmid N$, sk¹d wynika, ¿e $q \notin \{q_{1}, q_{2},..., q_{r}\}$, co jest sprzeczne z za³o¿eniem. 
\end{dowod}

\begin{twierdzenie} \cite[\mbox{s.} 46]{marzant}
Istnieje nieskoñczenie wiele liczb pierwszych postaci $4k+1$.
\end{twierdzenie}
\
\begin{twierdzenie}(Dirichlet) \cite[\mbox{s.} 47]{marzant}
Jeœli $m \in \mathbb{N}$, $a \in \mathbb{Z}$ oraz $(a,m)=1$, to w ci¹gu arytmetycznym $a+mk$, gdzie $k=1,2,...$, istnieje nieskoñczenie wiele liczb pierwszych.
\end{twierdzenie}

\begin{definicja}
Niech $n \in \mathbb{N}$. Liczbê w postaci
\begin{equation}
\label{liczbaFermata}
F_{n}=2^{2^{n}}+1,
\end{equation}
gdzie $n \geq 1$, nazywa siê \textit{n-t¹ liczb¹ Fermata}.
\end{definicja}

Fermat obliczy³, ¿e $F_{1}=5$, $F_{2}=17$, $F_{3}=2575$, $F_{4}=65537$ s¹ liczbami pierwszymi i za³o¿y³, ¿e ka¿da liczba postaci \ref{liczbaFermata} jest liczb¹ pierwsz¹. Hipotezê t¹ obali³ Euler, który udowodni³, ¿e $F_{5}$ jest podzielne przez $641$.

\begin{definicja} \cite{lpb}
Liczby pierwsze $p$ i $q=p+2$ nazywane s¹ \textit{liczbami pierwszymi bliŸniaczymi}.
\end{definicja}

Liczbami pierwszymi bliŸniaczymi s¹ np.: (3, 5), (11, 13), (1949, 1951), (4967, 4969). Najwiêksze znane dziœ liczby bliŸniacze, ka¿da sk³adaj¹ca siê z 388 342 cyfr, to 
$$\num{2996863034895} \cdot 2^{\num{1290000}} \pm 1,$$
znalezione w 2016 roku.

\begin{definicja} \cite{lpb}
\textit{Liczba pierwsza Sophie Germain} to dowolna liczba pierwsza $p$, dla której liczba $2p+1$ tak¿e jest liczb¹ pierwsz¹ (np. 23, gdy¿ $2 \cdot 23 +1 = 47$).
\end{definicja}

Najwiêksz¹ znan¹ obecnie liczb¹ pierwsz¹ Sophie Germain jest 
$$\num{2618163402417} \cdot 2^{\num{1290000}}-1,$$ a jej zapis dziesiêtny wymaga $\num{388342}$ cyfr. Zosta³a ona odkryta w 2016 roku.

\begin{definicja} \cite[\mbox{s.} 52]{marzant}
\textit{Liczbami Mersenne'a} s¹ liczby postaci $M_{n}=2^{n}-1$, $n \geq 1$. Je¿eli liczba Mersenne'a jest pierwsza to nazywa siê \textit{liczb¹ pierwsz¹ Mersenne'a}.
\end{definicja}

Nie wiadomo, czy istnieje nieskoñczenie wiele liczb pierwszych Mersenne'a. Do 2018 roku znanych ich 50. Co wiêcej, dziewiêæ na dziesiêæ najwiêkszych odkrytych do tej pory liczb pierwszych to w³aœnie liczby Mersenne'a. Zosta³y one przedstawione w Tabeli \ref{toptengreatestprimenumbersM}. Ich poszukiwaniem zajmuje siê projekt GIMPS (ang. Great Internet Mersenne Prime Search), w którym mog¹ wzi¹æ udzia³ ochotnicy z ca³ego œwiata.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Nr & Liczba pierwsza &  Liczba cyfr & Data odkrycia & Odkrywcy \\ [0.2ex] 
\hline \hline
1 & $2^{\num{77 232 917}}-1$ & 23 249 425 & 2018-01-03 & J. Pace, GIMPS\\
\hline
2 & $2^{\num{74 207 281}}-1$ & 22 338 618 & 2016-01-07 & Cooper, GIMPS\\
\hline
3 & $2^{\num{57 885 161}}-1$ & 17 425 170 & 2013-01-25 & Cooper, GIMPS\\
\hline
4 & $2^{\num{43 112 609}}-1$ & 12 978 189 & 2008-08-23 & Edson Smith, GIMPS\\
\hline
5 & $2^{\num{42 643 801}}-1$ & 12 837 064 & 2009-06-04 & Strindmo, GIMPS\\
\hline
6 & $2^{\num{37 156 667}}-1$ & 11 185 272 & 2008-09-06 & H. Elvenich, GIMPS\\
\hline
7 & $2^{\num{32 582 657}}-1$ & 9 808 358 & 2006-09-04 & Boone, Cooper, GIMPS\\
\hline
8 & $2^{\num{30 402 457}}-1$ & 9 152 052 & 2005-12-15 & Boone, Cooper, GIMPS\\
\hline
9 & $2^{\num{25 964 951}}-1$ & 7 816 230 & 2005-02-18 & Nowak, GIMPS\\
\hline
10 & $2^{\num{24 036 583}}-1$ & 7 235 733 & 2004-05-15 & Findley, GIMPS\\
\hline
\end{tabular}
\caption{Dziesiêæ najwiêkszych znanych liczb pierwszych Mersenne'a na 2018 rok \cite{gimps}.}
\label{toptengreatestprimenumbersM}
\end{center}
\end{table}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%
%%%%%%%%
%%%%%%%%      D R U G I    R O Z D Z I A £
%%%%%%%%
%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Testy pierwszoœci liczb}
Test pierwszoœci to algorytm, który okreœla, czy zadana liczba jest liczb¹ pierwsz¹, czy z³o¿on¹. Poni¿szy rozdzia³ ma na celu przedstawienie algorytmów, które testuj¹ pierwszoœæ zadanej liczby. 

\section{Testy deterministyczne}
\textbf{Testy deterministyczne} to testy, które wydaj¹ certyfikat pierwszoœci, czyli ich wynik jest prawid³owy z prawdopodobieñstwem 1. Zwracaj¹ odpowiedŸ, ¿e podana na wejœciu liczba $n$ jest pierwsza wtedy i tylko wtedy, gdy naprawdê tak jest, czyli wynik dzia³ania testu jest jednoznaczny.

\subsection{Metoda naiwna}
Najprostsz¹ deterministyczn¹ metod¹ testowania pierwszoœci jest \textit{metoda naiwna}. Algorytm dzia³ania jest bardzo prosty: dla danej liczby $n>2$ wystarczy sprawdziæ, czy dzieli siê ona kolejno przez $2,3,...,n-1$. Je¿eli wœród tych liczb nie ma dzielnika liczby $n$, wtedy $n$ jest pierwsza. Jeœli chocia¿ przez jedn¹ z tych liczb $n$ dzieli siê bez reszty, wtedy $n$ jest z³o¿ona.
 
Jak siê okazuje, nie trzeba testowaæ podzielnoœci przez wszystkie liczby od $2$ do $n-1$, wystarczy ograniczyæ siê do przedzia³u $2,3,...,\sqrt{n}$.

Co wiêcej, algorytm mo¿na ulepszyæ dziel¹c liczbê $n$ jedynie przez wszystkie liczby pierwsze mniejsze lub równe $\sqrt{n}$. Listê takich liczb mo¿emy wyznaczyæ sitem Eratostenesa \ref{sito}. 

Warto zauwa¿yæ, ¿e jeœli liczba $n$ oka¿e siê byæ z³o¿ona, to jednoczeœnie wyznaczany jest jej nietrywialny dzielnik.

Algorytm metody naiwnej w wersji udoskonalonej dzia³a nastêpuj¹co:
\begin{enumerate}
\item Pobierz liczbê $n$.
\item Wyznacz zbiór $p$ wszystkich liczb pierwszych mniejszych lub równych $\sqrt{n}$.
\item Dziel liczbê $n$ przez kolejne liczby ze zbioru $p$.
\item Jeœli $n$ dzieli siê przez przynajmniej jedn¹ z liczb ze zbioru $p$ bez reszty, wtedy $n$ jest z³o¿ona.
\item Jeœli wœród liczb $p$ nie ma dzielnika liczby $n$, wtedy $n$ jest pierwsza.
\end{enumerate}

Jest to algorytm deterministyczny, który uznaje pierwszoœæ liczby ze stuprocentow¹ pewnoœci¹. W zwi¹zku z tym, ¿e metoda jest bardzo dok³adna, wymaga a¿ $O(\sqrt{n}\lg^2{n})$ kroków, wiêc jej efektywnoœæ spada dla bardzo du¿ych liczb.

Algorytm metody naiwnej w programie Matlab zosta³ przedstawiony na koñcu tej pracy (skrypt \ref{metodanaiwna}. Tabela \ref{metodanaiwnatabela} przedstawia wyniki i czas dzia³ania algorytmu dla liczb o ró¿nej wielkoœci. 

\begin{center}
\begin{table}[H] 
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Testowana liczba & Czas dzia³ania programu $[s]$ & Liczba pierwsza/z³o¿ona \\ [0.2ex] 
\hline \hline
1 & $7$ & 0.005050 & pierwsza\\
\hline
2 & $23$ & 0.004529 & pierwsza\\
\hline
3 & $365$ & 0.002450 & z³o¿ona\\
\hline
4 & $\num{5737}$ & 0.002264 & pierwsza\\
\hline
5 & $\num{99487}$ & 0.015185 & pierwsza\\
\hline
6 & $\num{99489}$ & 0.014734 & z³o¿ona\\
\hline
7 & $\num{100001}$ & 0.013290 & z³o¿ona\\
\hline
8 & $\num{12192109}$ & 9.409341 & pierwsza\\
\hline
9 & $\num{14476001}$ & 11.304216 & pierwsza\\
\hline
10 & $\num{100000001}$ & 215.084406 & z³o¿ona\\
\hline
\end{tabular}
\caption{Wyniki dzia³ania funkcji testuj¹cej pierwszoœæ liczb metod¹ naiwn¹ z sitem Eratostenesa.}
\label{metodanaiwnatabela}
\end{table}
\end{center}
£atwo zauwa¿yæ, ¿e dla niewielkich liczb czas dzia³ania jest bardzo krótki, ale dla liczb rzêdu $10^{8}$ sprawdzanie pierwszoœci trwa ju¿ kilka minut.

\subsection{Test pierwszoœci AKS}
\textit{Test pierwszoœci AKS} (lub inaczej test pierwszoœci Agrawal-Kayal-Saxena lub cyklotomiczny test AKS) jest deterministycznym testem pierwszoœci liczb opracowanym przez trójkê indyjskich naukowców - Manindra Agrawala, Neeraja Kayala i~ Nitina Saxena z Indyjskiego Instytutu Technologii w Kanpurze. Test zosta³ po raz pierwszy opublikowany 6 sierpnia 2002 roku w artykule zatytu³owanym \textit{PRIMES is in P}. W 2006 roku autorzy otrzymali za to odkrycie dwie nagrody - Nagrodê Gödla, któr¹ przyznaje siê za osi¹gniêcia w dziedzinie informatyki teoretycznej, oraz nagrodê Fulkersona, przyznawan¹ za wybitne prace z zakresu matematyki dyskretnej.

Poni¿sze opracowanie opiera siê na artykule \textit{PRIMES is in P} \cite{aks}.

Test AKS jest pierwszym opublikowanym algorytmem testuj¹cym czy dana liczba jest pierwsza, który jest jednoczeœnie szybki, jednoznaczny i~ bezwarunkowy. Oznacza to, ¿e algorytm ten zawsze zwróci poprawn¹ odpowiedŸ (w przeciwieñstwie do testów probabilistycznych), a jego dzia³anie nie bazuje na ¿adnych nieudowodnionych hipotezach.

Test pierwszoœci AKS opiera siê na pewnej to¿samoœci liczb pierwszych, która jest uogólnieniem ma³ego twierdzenia Fermata \ref{mtf}.

\begin{lemat}(ma³e twierdzenie Fermata dla wielomianów)
\label{lematAKStresc}
Niech $a, n \in \mathbb{N}$ i $n \geq 2$ oraz $(a,n)=1$. Wówczas $n$ jest liczb¹ pierwsz¹ wtedy i tylko wtedy, gdy
\begin{equation}
\label{lematAKS}
(X+a)^{n}=X^{n}+a \ (mod \ n).
\end{equation}
\end{lemat}

\begin{dowod}
Równanie \ref{lematAKS} mo¿na zapisaæ w postaci
$$(X+a)^{n}-(X^{n}+a)=0 \ (mod \ n).$$

Dla $0 \leq i \leq n$ wspó³czynnik przy $X^{i}$ w wyra¿eniu $((X+a)^{n}-(X^{n}+a))$ wynosi ${n}\choose{i}$ $a^{n-i}$. 

Za³ó¿my, ¿e $n$ jest liczb¹ pierwsz¹. Wtedy ${n}\choose{i}$ $=0 \ (mod \ n)$, a wiêc wszystkie wspó³czynniki s¹ zerowe.

Za³ó¿my, ¿e $n$ jest liczb¹ z³o¿on¹. Rozwa¿my liczbê pierwsz¹ $q$, która jest dzielnikiem $n$ i dla pewnego $k$ niech $q^{k} \mid n$. Wtedy $q^{k}$ nie dzieli ${n}\choose{q}$ i jest wzglêdnie pierwsza z $a^{n-q}$. St¹d wspó³czynnik przy $X^{q}$ jest niezerowy (mod $n$). Zatem wyra¿enie $((X+a)^{n}-(X^{n}+a))$ nie jest to¿samoœciowo równe zero (mod $n$).
\end{dowod}

Powy¿sza to¿samoœæ sugeruje prosty test pierwszoœci: pobieramy badane $n$, wybieramy $a$ i sprawdzamy, czy kongruencja \ref{lematAKS} jest spe³niona. Jednak wymaga to czasu, poniewa¿ w najgorszym przypadku nale¿y oszacowaæ $n$ wspó³czynników po lewej stronie równania. Prostym sposobem na zmniejszenie liczby tych wspó³czynników jest oszacowanie obu stron kongruencji \ref{lematAKS} modulo wielomian postaci $X^{r}-1$ dla odpowiednio wybranego ma³ego $r$. Innymi s³owy, sprawdziæ, czy spe³nione jest równanie
\begin{equation}
\label{lematAKSnowe}
(X+a)^{n}=X^{n}+a \ (mod \ X^{r}-1,n).
\end{equation}
Z Lematu \ref{lematAKStresc} wynika natychmiast, ¿e wszystkie liczby pierwsze $n$ spe³niaj¹ równanie \ref{lematAKSnowe} dla wszystkich wartoœci $a$ i $r$. Problem polega na tym, ¿e niektóre liczby z³o¿one $n$ mog¹ równie¿ spe³niæ równanie dla kilku wartoœci $a$ i $r$. Jednak mo¿emy pokazaæ, ¿e dla odpowiednio dobranego $r$, jeœli równanie \ref{lematAKSnowe} jest spe³nione dla kilku $a$, to $n$ musi byæ potêg¹ liczby pierwszej.

Algorytm dzia³ania metody AKS jest nastêpuj¹cy:
\begin{enumerate}
\item Wybierz testowan¹ liczbê $n>1$.
\item Jeœli istnieje takie $a \in \mathbb{N}$ i $b>1$, ¿e $n=a^{b}$, to liczba $n$ jest z³o¿ona - stop.
\item ZnajdŸ najmniejsze $r$ takie, ¿e $o_{r}(n)>(log_{2} n)^{2}$.
\item Jeœli $1 < NWD(a,n) < n$ dla pewnego $a \leq r$, wtedy $n$ jest z³o¿ona - stop.
\item Jeœli $n \leq t$, $n$ jest pierwsza - stop.
\item Dla $a=1$ do $\lfloor \sqrt{\varphi(r)}log_{2} n \rfloor$ rób \\
jeœli $((X+a)^{n} \neq X^{n}+a \ (mod \ X^{r}-1,n))$, $n$ jest z³o¿ona - stop.
\item $n$ jest pierwsza.
\end{enumerate}


Kod metody AKS zaimplementowany w œrodowisku Matlab zosta³ przedstawiony w czêœci pracy poœwiêconej skryptom (skrypt \ref{testaks}). Tabela poni¿ej przedstawia wyniki i czas dzia³ania testu pierwszoœci AKS.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Pierwsza/z³o¿ona &  Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline
1 & $3$ & pierwsza & $0.034859$\\
\hline

2 & $23$ & pierwsza & $0.047291$\\
\hline

3 & $25$ & z³o¿ona & $0.009026$\\
\hline

4 & $123$ & z³o¿ona & $0.045841$\\
\hline

5 & $199$ & pierwsza & $4.284376$\\
\hline

6 & $1000$ & z³o¿ona & $0.020794$\\
\hline

7 & $1001$ & z³o¿ona & $0.047622$\\
\hline

8 & $1223$ & pierwsza & $35.298198$\\
\hline

9 & $3313$ & pierwsza & $113.642901$\\
\hline

10 & $3315$ & z³o¿ona & $0.044053$\\
\hline

\end{tabular}
\caption{Wartoœæ funkcji $\varphi(n)$ dla liczb o ró¿nej wielkoœci.}
\end{center}
\end{table}

£atwo zauwa¿yæ, ¿e algorytm radzi sobie bardzo szybko z liczbami z³o¿onymi i~ niewielkimi liczbami pierwszymi, jednak ju¿ dla liczb pierwszych czterocyfrowych potrzebne jest ponad pó³ minuty na potwierdzenie ich pierwszoœci. Test AKS ma niestety znikom¹ wartoœæ praktyczn¹, poniewa¿ z³o¿onoœæ tego algorytmu jest du¿a, a to oznacza, ¿e liczba wykonywanych operacji roœnie bardzo szybko wraz ze wzrostem wielkoœci badanej liczby.  

%\subsection{Algorytm Millera}
%nie ma w internecie :(

\subsection{Test pierwszoœci APR}

\subsection{Test Lucasa-Lehmera}

\section{Testy probabilistyczne}
\textit{Testy probabilistyczne} (znane tak¿e jako testy randomizacyjne) s¹ obecnie najczêœciej stosowanymi i najbardziej efektywnymi testami pierwszoœci liczb, które w swoim dzia³aniu u¿ywaj¹ losowoœci. Wykorzystuje siê w nich losowo wygenerowane liczby z zadanego przedzia³u. Zale¿noœæ od takich elementów powoduje, ¿e algorytm mo¿e daæ b³êdny wynik testu pierwszoœci, lecz prawdopodobieñstwo takiego zdarzenia jest bardzo ma³e.

\subsection{Test pierwszoœci Fermata}
Zgodnie z ma³ym twierdzeniem Fermata \ref{mtf} dla liczb pierwszych $p$ zachodzi kongruencja
\begin{equation}
\label{mtfw}
a^{p-1} \equiv 1 \ (mod \ p).
\end{equation}

\textit{Test pierwszoœci Fermata} \cite[\mbox{s.} 49]{zakrzew} to probabilistyczny test pierwszoœci, który opiera siê na za³o¿eniu, ¿e zachodzi wynikanie odwrotne do Twierdzenia \ref{mtf}, czyli jeœli prawdziwa jest kongruencja \ref{mtfw}, to liczba $p$ jest pierwsza z du¿ym prawdopodobieñstwem.

Algorytm testu pierwszoœci Fermata dla zadanej liczby $p$ wygl¹da nastêpuj¹co:
\begin{enumerate}
\item Wylosuj $a \in [2,p-2]$.
\item Oblicz $d = NWD(a,p)$. Jeœli $d>1$ to $p$ jest liczb¹ z³o¿on¹.
\item SprawdŸ zachodzenie kongruencji $a^{p-1} \equiv 1 \ (mod \ p)$.
\item Jeœli zachodzi, to $p$ mo¿e byæ liczb¹ pierwsz¹, w innym przypadku $p$ jest liczb¹ z³o¿on¹.
\end{enumerate}

Przy kilkukrotnym powtórzeniu losowania dla ró¿nych liczb test Fermata daje bardzo wiarygodny wynik. 

Implementacja testu pierwszoœci Fermata w programie Matlab przedstawiona zosta³a w skrypcie \ref{testFermata}. Tabela \ref{tabelaFermat} przedstawia wyniki dzia³ania tego kodu dla ró¿nych liczb pierwszych i z³o¿onych oraz czas dzia³ania algorytmu.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & Liczba $p$ & Liczba powtórzeñ $n$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & $2$ & pierwsza $(100\%)$ & $0.069366$ \\
\hline

2 & $15$ & $8$ & z³o¿ona $(100\%)$ & $0.097156$ \\
\hline

3 & $47$ & $18$ & pierwsza $(100\%)$  & $0.102425$\\
\hline

4 & $199$ & $28$ & pierwsza $(100\%)$  & $0.090658$\\
\hline

5 & $\num{1999}$ & $68$ & pierwsza $(100\%)$ & $0.092615$\\
\hline

6 & $\num{6899}$ & $190$ & pierwsza $(100\%)$ & $0.095254$\\
\hline

7 & $\num{94427}$ & $19$ & pierwsza $(100\%)$ & $0.080347$\\
\hline

8 & $\num{94428}$ & $19$ & z³o¿ona $(100\%)$ & $0.070723$\\
\hline

9 & $\num{15472147}$ & $30$ & pierwsza $(100\%)$ & $0.071718$\\
\hline

10 & $\num{15472147}$ & $5530$ & pierwsza $(100\%)$ & $0.733975$\\
\hline

11 & $\num{15472148}$ & $5530$ & z³o¿ona $(100\%)$ & $0.575719$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Fermata dla liczb o ró¿nej wielkoœci.}
\label{tabelaFermat}
\end{center}
\end{table}

£atwo zauwa¿yæ, ¿e algorytm dzia³a niezwykle szybko i zwraca stuprocentowo pewny wynik nawet dla bardzo du¿ych liczb. Czas dzia³ania zale¿y g³ównie od wyboru liczby powtórzeñ $n$ - im liczba $n$ jest wiêksza, tym czas dzia³ania algorytmu siê wyd³u¿a. Jednak ju¿ dla niewielkich $n$ wynik jest podawany z prawdopodobieñstwem równym $1$.   

Trzeba zaznaczyæ, ¿e kongruencja \ref{mtfw} mo¿e zachodziæ tak¿e w pewnych przypadkach, gdy $p$ nie jest liczb¹ pierwsz¹. Liczby te omówione zosta³y poni¿ej.

\begin{definicja} \cite[\mbox{s.} 49]{zakrzew}
\textit{Liczby Carmichaela} to z³o¿one liczby naturalne, dla których teza ma³ego twierdzenia Fermata \ref{mtf} jest prawdziwa. Liczba naturalna $n$ jest liczb¹ Carmichaela wtedy i tylko wtedy, gdy jest liczb¹ z³o¿on¹ i dla ka¿dej liczby naturalnej $a$ z przedzia³u $1 < a < n$, wzglêdnie pierwszej z $n$, liczba $a^{n-1}-1$ jest podzielna przez $n$.
\end{definicja}

Najmniejsz¹ liczb¹ Carmichaela jest $561 = 3 \cdot 11 \cdot 17$. Innymi z nich s¹ na przyk³ad $1105 = 5 \cdot 13 \cdot 17$, $1729 = 7 \cdot 13 \cdot 19$ lub $2465 = 5 \cdot 17 \cdot 29$.

Test Fermata zastosowany do liczby Carmichaela jest nieskuteczny, co pokazuje Tabela \ref{tabelaFermatCarm}.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & L. Carmichaela & Liczba powtórzeñ $n$ & Wynik & Czas dzia³ania $[s]$ \\ [0.2ex] 
\hline \hline

1 & $561$ & $5$ & pierwsza $(60\%)$ & $0.064905$ \\
\hline

2 & $561$ & $15$ & pierwsza $(73\%)$ & $0.097156$ \\
\hline

3 & $561$ & $150$ & pierwsza $(58\%)$  & $0.102425$\\
\hline

4 & $1105$ & $5$ & pierwsza $(100\%)$  & $0.067776$\\
\hline

5 & $1105$ & $15$ & pierwsza $(73\%)$ & $0.068222$\\
\hline

6 & $1105$ & $150$ & pierwsza $(70.6\%)$ & $0.088589$\\
\hline

7 & $1729$ & $5$ & pierwsza $(60\%)$ & $0.069128$\\
\hline

8 & $1729$ & $15$ & z³o¿ona $(66.67\%)$ & $0.078923$\\
\hline

9 & $1729$ & $150$ & pierwsza $(76.67\%)$ & $0.082983$\\
\hline

10 & $2465$ & $5$ & pierwsza $(80\%)$ & $0.064879$\\
\hline

11 & $2465$ & $15$ & pierwsza $(60\%)$ & $0.070719$\\
\hline

12 & $2465$ & $150$ & pierwsza $(75.3\%)$ & $0.090890$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Fermata dla liczb Carmichaela.}
\label{tabelaFermatCarm}
\end{center}
\end{table}

Jak wynika z powy¿szej tabeli, liczby Carmichaela przechodz¹ test pierwszoœci Fermata z du¿ym prawdopodobieñstwem.

\subsection{Test pierwszoœci Lehmana}
\textit{Test Lehmana} \cite[\mbox{s.} 60]{karbowski} jest kolejnym testem probabilistycznym pierwszoœci liczb. Algorytm testu Lehmana dla du¿ej liczby $p$ wygl¹da nastêpuj¹co:
\begin{enumerate}
\item Wylosuj du¿¹ liczbê $a < p$.
\item Oblicz $b=a^{(p-1)/2} \ (mod \ p)$.
\item Jeœli $b \equiv 1 \ (mod \ p)$ lub $b \equiv -1 \ (mod \ p)$ to $p$ jest liczb¹ pierwsz¹ z prawdopodobieñstwem wiêkszym lub równym $50\%$. W przeciwnym wypadku $p$ jest liczb¹ z³o¿on¹. 
\end{enumerate}

Skrypt \ref{testLehmana} przedstawia algorytm Lehmana w programie Matlab. Wyniki dzia³ania programu przedstawione zosta³y w Tabeli \ref{tabelaLehman}.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $p$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & pierwsza $(\geq 50\%)$ & $0.023871$ \\
\hline

2 & $47$ & pierwsza $(\geq 50\%)$ & $0.032829$ \\
\hline

3 & $199$ & pierwsza $(\geq 50\%)$  & $0.031084$\\
\hline

4 & $\num{1999}$ & pierwsza $(\geq 50\%)$ & $0.026158$ \\
\hline

5 & $\num{6899}$ & pierwsza $(\geq 50\%)$ & $0.029798$\\
\hline

6 & $\num{94427}$ & pierwsza $(\geq 50\%)$ & $0.023563$ \\
\hline

7 & $\num{94428}$ & z³o¿ona $(100\%)$ & $0.015226$\\
\hline

8 & $\num{15472145}$ & z³o¿ona $(100\%)$ & $0.027043$\\
\hline

9 & $\num{15472147}$ & pierwsza $(\geq 50\%)$ & $0.026316$\\
\hline

10 & $\num{15485857}$ & pierwsza $(\geq 50\%)$ & $0.024070$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Lehmana dla liczb o ró¿nej wielkoœci.}
\label{tabelaLehman}
\end{center}
\end{table}

Algorytm Lehmana jest bardzo szybki i zwraca prawid³owe wyniki dla liczb o ró¿nej wielkoœci.

\subsection{Test pierwszoœci Solovaya-Strassena}
Kolejnym probabilistycznym testem pierwszoœci jest test Solovaya-Strassena, opracowany przez dwóch matematyków - amerykañskiego profesora Roberta M. Solovaya i profesora Volkera Strassena z Niemiec. Do wprowadzenia algorytmu testowania niezbêdna jest definicja symbolu Legendre’a.

\begin{definicja}
Niech $p$ bêdzie liczb¹ pierwsz¹ wiêksz¹ od 2, a $a$ liczb¹ ca³kowit¹. \textit{Symbol Legendre'a} $\left( \frac{a}{p} \right)$ definiuje siê nastêpuj¹co

$$
\left( \frac{a}{p} \right)= \left\{ \begin{array}{ll}
0, \textrm{ jeœli} a \textrm{jest wielokrotnoœci¹ liczby} p,\\
1, \textrm{jeœli istnieje } b \textrm{takie, ¿e } b^{2}=a \ (mod \ p),\\
-1, \textrm{jeœli nie istnieje ¿adne $b$ takie, ¿e} b^{2}=a \ (mod \ p).
\end{array} \right.
$$
\end{definicja}

Symbol Legendre'a mo¿na obliczyæ nastêpuj¹cym wzorem
$$\left( \frac{a}{p} \right) \equiv a^{\frac{p-1}{2}} \ (mod \ p).$$

Symbol Legendre'a mo¿e byæ uogólniony do \textit{symbolu Jacobiego} $\left(\frac {a}{n}\right)$, gdzie $n$ jest dowoln¹ liczb¹ nieparzyst¹, która ma rozk³ad na czynniki pierwsze 
$$n=p_{1}^{m_{1}} \cdot p_{2}^{m_{2}} \cdot ... \cdot p_{k}^{m_{k}}.$$
Wtedy symbol Jacobiego mo¿na zapisaæ w postaci
$$\left(\frac {a}{n}\right)=\left(\frac {a}{p_{1}}\right)^{m_{1}} \cdot \left(\frac {a}{p_{2}}\right)^{m_{2}} \cdot ... \cdot \left(\frac {a}{p_{k}}\right)^{m_{k}}.$$
Je¿eli $n$ jest liczb¹ pierwsz¹ to symbol Jacobiego i symbol Legendre'a s¹ sobie równe.

\begin{definicja}
Jeœli $n$ jest liczb¹ z³o¿on¹ nieparzyst¹, a liczba $b$, wzglêdnie pierwsza z $n$, spe³nia warunek
\begin{equation}
b^{\frac{n-1}{2}} \equiv \left( \frac{b}{n} \right) \ (mod \ n),
\end{equation}
to $n$ jest \textit{pseudopierwsz¹ liczb¹ Eulera} przy podstawie $b$.
\end{definicja}

Test pierwszoœci liczby $n$ algorytmem Solovaya-Strassena przebiega nastêpuj¹co
\begin{enumerate}
\item Losujemy $b \in \{2,...,n-2\}$.
\item Obliczamy $r = b^{\frac{n-1}{2}} \ (mod \ n)$. Jeœli $r \neq \pm 1$, to $n$ jest liczb¹ z³o¿on¹.
\item Obliczamy $s = \left( \frac{b}{n} \right)$. Jeœli $r \neq s$, to $n$ jest z³o¿ona.
\end{enumerate} 

Je¿eli po zakoñczeniu algorytmu nie ma odpowiedzi "n jest z³o¿ona", to test nale¿y powtórzyæ. Po $k$-krotnym powtórzeniu testu i stwierdzeniu, ¿e $n$ jest liczb¹ pseudopierwsz¹ Eulera przy ka¿dej z wybranych podstaw $b$, prawdopodobieñstwo, ¿e liczba $n$ jest jednak z³o¿ona wynosi $\frac{1}{2^{k}}$.

%bibliografia - notatki z wykladu Teoria Liczb i elementy kryptografii

Skrypt jednorazowego przejœcia algorytmu testu pierwszoœci Solovaya-Strassena w programie Matlab zosta³ przedstawiony na koñcu pracy (skrypt \ref{testSS}). Tabela \ref{tabelaSS} przedstawia wyniki otrzymane za pomoc¹ powy¿szego algorytmu i czas dzia³ania funkcji dla ka¿dej operacji.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & pierwsza & $0.034387$ \\
\hline

2 & $47$ & pierwsza & $0.032534$ \\
\hline

3 & $199$ & pierwsza & $0.039209$\\
\hline

4 & $\num{1999}$ & pierwsza & $0.032661$ \\
\hline

5 & $\num{6899}$ & pierwsza & $0.036613$\\
\hline

6 & $\num{94427}$ & pierwsza & $0.034677$ \\
\hline

7 & $\num{94428}$ & z³o¿ona & $0.017758$\\
\hline

8 & $\num{15472145}$ & z³o¿ona & $0.027369$\\
\hline

9 & $\num{15472147}$ & pierwsza & $0.056256$\\
\hline

10 & $\num{15485857}$ & pierwsza & $0.033962$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Solovaya-Strassena dla liczb o ró¿nej wielkoœci.}
\label{tabelaSS}
\end{center}
\end{table}

\subsection{Test pierwszoœci Millera-Rabina}
\textit{Test pierwszoœci Millera-Rabina} jest kolejnym testem probabilistycznym, który z pewnym prawdopodobieñstwem okreœla, czy dana liczba jest pierwsza, czy z³o¿ona. Oryginalna wersja tego testu, stworzona przez profesora Gary'ego L. Millera, jest testem deterministycznym, lecz jego prawid³owoœæ bazuje na uogólnionej hipotezie Riemanna, która nie zosta³a dotychczas udowodniona. W 1975 roku kryptolog Michael O. Rabin przekszta³ci³ algorytm Millera do algorytmu probabilistycznego.

\begin{fakt}
Niech $n$ bêdzie nieparzyst¹ liczb¹ pierwsz¹ i niech $n-1=2^{s} \cdot t$, gdzie $2 \nmid t$. Niech $b \in \phi(n)$. Wtedy albo $b^{t} \equiv 1$ (mod $n$), albo $b^{2^{r}t} \equiv -1$ (mod $n$) dla pewnego $r \in \{0,1,...,s-1\}$.  
\end{fakt}

\begin{definicja}
Niech $n$ bêdzie nieparzyst¹ liczb¹ z³o¿on¹ i niech $n-1=2^{s} \cdot t$, gdzie $2 \nmid t$. Niech $b \in \phi(n)$. Je¿eli
\begin{itemize}
\item $b^{t} \equiv 1$ (mod $n$) lub
\item $b^{2^{r}t} \equiv -1$ (mod $n$) dla pewnego $r \in \{0,1,...,s-1\}$
\end{itemize}
to liczbê $n$ nazywamy \textit{liczb¹ silnie pseudopierwsz¹} przy podstawie $b$. 
\end{definicja}

\begin{fakt}
Jeœli $n$ jest nieparzyst¹ liczb¹ z³o¿on¹, to jest silnie pseudopierwsza przy podstawie $b$ dla co najwy¿ej $25\%$ wszystkich podstaw $b$ takich, ¿e $0 < b < n$. 
%Dok³adniej, dla n 6= 9 liczba takich podstaw nie przekracza ?(n)/4.
\end{fakt}
Algorytm dzia³ania testu pierwszoœci Millera-Rabina przebiega nastêpuj¹co:
\begin{enumerate}
\item Obliczamy $n-1=2^{s} \cdot t$, gdzie $t$ jest liczb¹ nieparzyst¹.
\item Losujemy $b \in \{2,...,n-2\}$.
\item Obliczamy $a = b^{t}$ mod $n$. Jeœli $a=\pm 1$, to $n$ mo¿e byæ pierwsza.
\item Obliczamy $a = b^{2^{r}t}$ (mod $n$) dla $0 < r < s$. Jeœli dla pewnego $r$ otrzymamy $a = -1$, to $n$ mo¿e byæ pierwsza, w przeciwnym razie $n$ jest z³o¿ona.
\end{enumerate}
Po otrzymaniu odpowiedzi "$n$ jest pierwsza" powtarzamy kroki algorytmu 2-4. 

Skrypt testu pierwszoœci Millera-Rabina przedstawiony zosta³ w dalszej czêœci pracy (skrypt \ref{testMR}). Tabela \ref{tabelaMR} przedstawia wyniki otrzymane za pomoc¹ powy¿szego algorytmu i czas dzia³ania funkcji dla ka¿dej operacji.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & pierwsza & $0.036212$ \\
\hline

2 & $47$ & pierwsza & $0.036644$ \\
\hline

3 & $199$ & pierwsza & $0.038669$\\
\hline

4 & $\num{1999}$ & pierwsza & $0.037960$ \\
\hline

5 & $\num{6899}$ & pierwsza & $0.037959$\\
\hline

6 & $\num{94427}$ & pierwsza & $0.040197$ \\
\hline

7 & $\num{94428}$ & z³o¿ona & $0.018025$\\
\hline

8 & $\num{15472145}$ & z³o¿ona & $0.049525$\\
\hline

9 & $\num{15472147}$ & pierwsza & $0.035766$\\
\hline

10 & $\num{15485857}$ & pierwsza & $0.045164$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Millera-Rabina dla liczb o ró¿nej wielkoœci.}
\label{tabelaMR}
\end{center}
\end{table}

\subsection{Chiñski test pierwszoœci}


%\section{Test pierwszoœci ECPP}

\chapter{Zastosowania w kryptografii}
\chapter*{Skrypty z programu Matlab}

\section*{Sito Eratostenesa}
\lstinputlisting[frame=single, label = sitoEratostenesa, caption = Skrypt funkcji Sito Eratostenesa.]{sitoEratostenesa.m}

\section*{Sito Sundarama}
\lstinputlisting[frame=single, label = sitoSundarama, caption = Skrypt funkcji Sito Sundarama.]{sitoSundarama.m}

\section*{Funkcja Eulera}
\lstinputlisting[frame=single, label = funkcjaEulera, caption = Skrypt funkcji Eulera.]{euler_phi.m}

\section*{Rz¹d multiplikatywny}
\lstinputlisting[frame=single, label = multorder, caption = Skrypt funkcji licz¹cej rz¹d multiplikatywny.]{mult_order.m}

\newpage
\section*{Metoda naiwna}
\lstinputlisting[frame=single, label = metodanaiwna, caption = Algorytm metody naiwnej.]{MetodaNaiwna.m}

\section*{Test pierwszoœci AKS}
\lstinputlisting[frame=single, label = testaks, caption = Skrypt testu pierwszoœci AKS.]{MetodaAKS.m}

\newpage
\section*{Test pierwszoœci Fermata}
\lstinputlisting[frame=single, label = testFermata, caption = Skrypt testu pierwszoœci Fermata.]{testFermata.m}

\section*{Test pierwszoœci Lehmana}
\lstinputlisting[frame=single, label = testLehmana, caption = Skrypt testu pierwszoœci Lehmana.]{testLehmana.m}

\section*{Test pierwszoœci Solovaya-Strassena}
\lstinputlisting[frame=single, label = testSS, caption = Skrypt testu pierwszoœci Solovaya-Strassena.]{testSolovaya.m}

\section*{Test pierwszoœci Millera-Rabina}
\lstinputlisting[frame=single, label = testMR, caption = Skrypt testu pierwszoœci Millera-Rabina.]{TestMilleraRabina.m}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%      B I B L I O G R A F I A
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{9}

\bibitem{karbowski} M. Karbowski, \textit{Podstawy kryptografii}, Wydanie III, Helion, Gliwice, (2014).
\bibitem{marzant} W. Marzantowicz, P. Zarzycki, \textit{Elementarna teoria liczb}, Wydawnictwo Naukowe PWN, Warszawa, (2006).
\bibitem{narkiewicz} W. Narkiewicz, \textit{Teoria liczb}, Wydawnictwo Naukowe PWN, Warszawa, (2003).
\bibitem{sierpinski} W. Sierpiñski, \textit{Wstêp do teorii liczb}, Wydawnictwa Szkolne i Pedagogiczne, (1987).
\bibitem{zakrzew} M. Zakrzewski, \textit{Teoria liczb}, Wydanie I, Oficyna Wydawnicza GiS, Wroc³aw, (2017).
\bibitem{lpb} \url{http://primes.utm.edu/largest.html} (dostêp 25.03.2018)
\bibitem{gimps} \url{https://www.mersenne.org/primes/} (dostêp 25.03.2018)
\bibitem{spiralaulama} \url{http://mathworld.wolfram.com/PrimeSpiral.html}(dostêp 24.03.2018)
\bibitem{aks} \url{https://www.cse.iitk.ac.in/users/manindra/algebra/primality_v6.pdf} (dostêp 25.03.2018)
\bibitem{multord} \url{https://en.wikipedia.org/wiki/Multiplicative_order}
\end{thebibliography}
\end{document}
