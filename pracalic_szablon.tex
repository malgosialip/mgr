\documentclass[12pt,twoside,a4]{mwbk}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% polonizacja
%\usepackage[polish]{babel} 
\usepackage[T1]{fontenc} 
\usepackage[cp1250]{inputenc}
\usepackage{polski}
\usepackage{enumerate}
\usepackage{graphicx} 
\usepackage{hyperref}
\usepackage{float}
\usepackage{siunitx}


%%MATLAB%%
\usepackage{listings}
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}

\lstset{language=Matlab,%
    %basicstyle=\color{red},
    breaklines=true,%
    morekeywords={matlab2tikz},
    keywordstyle=\color{blue},%
    morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
    identifierstyle=\color{black},%
    stringstyle=\color{mylilas},
    commentstyle=\color{mygreen},%
    showstringspaces=false,%without this there will be a symbol in the places where there is a space
    numbers=left,%
    numberstyle={\tiny \color{black}},% size of the numbers
    numbersep=9pt, % this defines how far the numbers are from the text
    emph=[1]{for,end,break},emphstyle=[1]\color{red}, %some words to emphasise
    %emph=[2]{word1,word2}, emphstyle=[2]{style},    
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%przerwa miêdzy liniami
\linespread{1.3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% deklaracja sposobu wyœwietlania rozdzia³u
\DeclareSectioningCommand[breakbefore]{chapter}{1}
{24pt plus5pt minus2pt}
{\LARGE\textbf{\ifHeadingNumbered\HeadingNumber.\enspace\fi\HeadingText}}
{10pt plus3pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% zmiana wyœwietlania spis treœci
\usepackage{tocloft}
\renewcommand\cftchapfont{\normalfont}
\renewcommand{\cftchapleader}{\cftdotfill{\cftsecdotsep}}
\renewcommand\cftchappagefont{\normalfont}
\renewcommand{\cftdotsep}{0.2}
\renewcommand\cftchapdotsep{\cftdot}
\setlength{\cftbeforechapskip}{0pt}
\renewcommand{\chaptername}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% sposób wyœwietlania numerów: wzorów, rysunków, tabel
\renewcommand{\thetable}{\thechapter.\arabic{table}}  
\renewcommand{\thefigure}{\thechapter.\arabic{figure}} 
\renewcommand{\theequation}{\thechapter.\arabic{equation}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% za³¹czanie grafi
%% proszê umieszczaæ pliki w katalogu g³ównym dokumentu, 
%% proszê pamiêtaæ, ¿e logo te¿ powinno tam byæ
\usepackage{graphicx}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% marginesy
\usepackage[a4paper,top=2.5cm,foot=2cm,left=3.5cm,right=2.5cm]{geometry}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pagina ¿ywa, a w³aœciwie jej brak
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[RO,LE]{\thepage~}
\fancyhead{}
\renewcommand{\headrulewidth}{0pt}%{}
\setlength{\footskip}{10mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% zmiana itemize na kropki
\usepackage{enumitem}
\setitemize[1]{label=$\bullet$}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pakiety ,,matematyczne''  
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Twierdzenia, definicje, i inne
\newtheorem{twierdzenie}{Twierdzenie}[chapter]
\theoremstyle{definition}
\newtheorem{definicja}{Definicja}[chapter]
\newtheorem{lemat}{Lemat}[chapter]
\newtheorem{wniosek}{Wniosek}[chapter]
\newtheorem{przyklad}{Przyk³ad}[chapter]
\newtheorem{uwaga}{Uwaga}[chapter]
\newtheorem{fakt}{Fakt}[chapter]
\newtheorem{propozycje}{Propozycje}[chapter]
\newenvironment{dowod}[1][Dowód]{\noindent\textbf{#1.} }{\newline\smallskip \hfill \rule{0.5em}{0.5em}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% brak numeracji strony na pierwszej stronie rozdzia³u
\usepackage{nopageno}


\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%strona tytu³owa
\renewcommand{\maketitle}{
\begin{titlepage}
  \begin{center}
    {\Large \bf POLITECHNIKA POZNAÑSKA}\\
    \vspace{0.15in}
    {\large \bf WYDZIA£ ELEKTRYCZNY}\\
    \vspace{0.15in}
    {\large \bf Instytut Matematyki}\\
    \vspace{0.3in}
    
    %Logo 
    \begin{figure}[h]
    \centering
    \includegraphics[height=1.5in]{logoPP.jpg}
    \end{figure}

    \vspace{0.7in}
%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% odpowiednie s³owo wykasowaæ
    {\large PRACA DYPLOMOWA MAGISTERSKA}\\
    \vspace{0.15in}
    \textsc{\@title}
  \end{center}

 \begin{center}
   \vspace{0.8in}
   {\LARGE \centering \@author} \par
 \end{center}

 \begin{flushleft}
    \vspace{1.2in}
     \hspace{4in}{Promotor:}\\
%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% wpisaæ nazwisko promotora
     \hspace{4in}{dr hab. Ma³gorzata Migda}\\
  \end{flushleft}
    \vspace*{\stretch{1}}
    \begin{center}
    POZNAÑ, 2018 
    \end{center}
\end{titlepage}}

\makeatother
%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% wpisaæ swoje nazwisko
\author{Ma³gorzata Lipiñska}

%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% wpisaæ tytu³
\title{{\Large \bf TESTY PIERWSZOŒCI LICZB I ICH ZASTOSOWANIA W KRYPTOGRAFII\\ \vspace{0.15in} }}

%koniec strony tytu³owej

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pocz¹tek dokumentu
\begin{document}

\pagestyle{empty}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pierwsza strona - strona tytu³awa
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% druga strona - pusta strona
\newpage
\mbox{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% trecia strona
\newpage
\thispagestyle{empty}
    \vspace*{1cm}
   \begin{center} 
   {\Large \bf KARTA PRACY DYPLOMOWEJ Z DZIEKANATU\\
   (kserokopia z podpisami)}
   \end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% czwarta strona - pusta strona
\newpage
\mbox{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Podziekowania
\newpage
\vspace*{\stretch{1}}

\hspace{7cm}
\begin{minipage}{7cm}
{\Large Podziêkowania}
\vspace{5mm}

%% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
%% chyba zmieniæ podziêkowania ;-)

Sk³adam serdecznie podziêkowania

\quad moim rodzicom,

\end{minipage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% pusta strona
\newpage
\mbox{ }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% spis treœci
\newpage
\pagestyle{fancy}
\tableofcontents


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%
%%%%%%%%
%%%%%%%%      W S T Ê P
%%%%%%%%
%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{Wstêp}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%
%%%%%%%%
%%%%%%%%    P I E R W S Z Y    R O Z D Z I A £
%%%%%%%%
%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Liczby pierwsze}
\section{Zasadnicze twierdzenie arytmetyki i twierdzenie Euklidesa}
\begin{definicja}
\textit{Liczb¹ pierwsz¹} nazywa siê liczbê naturaln¹ wiêksz¹ od 1, która ma dok³adnie dwa dzielniki: jedynkê i sam¹ siebie. Zbiór wszystkich liczb pierwszych oznacza siê liter¹ $\mathbb{P}$.
\end{definicja}

Liczb¹ z³o¿on¹ jest wiêc liczba, która ma wiêcej ni¿ dwa dzielniki. Warto zauwa¿yæ, ¿e 1 nie jest liczb¹ ani pierwsz¹, ani z³o¿on¹.

\begin{definicja}
\textit{Liczby wzglêdnie pierwsze} to liczby ca³kowite, których najwiêkszym wspólnym dzielnikiem jest liczba $1$. Jeœli dwie liczby $a$ i $b$ s¹ wzglêdnie pierwsze to zapisuje siê to jako $NWD(a,b)=1$ lub $(a,b)=1$.
\end{definicja}

\begin{definicja}
\textit{Liczba ca³kowita $b$ jest podzielna przez liczbê ca³kowit¹ $a$}, jeœli istnieje taka liczba ca³kowita $e$, ¿e zachodzi $b = ae$. Wtedy liczba $a$ jest dzielnikiem liczby $b$, z kolei o liczbie $b$ mówi siê, ¿e jest wielokrotnoœci¹ $a$.
Jeœli liczba $b$ jest podzielna przez $a$ ($a$ dzieli $b$), to u¿ywa siê oznaczenia $a \mid b$, natomiast w przeciwnym przypadku stosuje siê oznaczenie $a \nmid b$ \cite[\mbox{s.} 3]{marzant}.
\end{definicja}

\begin{lemat}(Euklides)
\label{Euklideslemat}
Jeœli liczba pierwsza $p$ dzieli iloczyn $ab$, to dzieli przynajmniej jeden z tych czynników. Inaczej, jeœli $p \in \mathbb{P}$ oraz $p \mid ab$, to $p \mid a$ lub $p \mid b$.
\end{lemat}

\begin{dowod}
Przyjmijmy, ¿e $p \nmid a$, czyli $NWD(a,p) = 1$, gdy¿ $p \in \mathbb{P}$. Wtedy $p \mid b$.
\end{dowod}

\begin{lemat}
\label{dzieleniek}
Je¿eli $p \in \mathbb{P}$ i $p \mid a_{1} \cdot ... \cdot a_{n}$, to istnieje $k$ ($1 \leq k \leq n$), takie ¿e $p \mid a_{k}$.
\end{lemat}

\begin{dowod}
Dowód wynika wprost z dowodu Lematu \ref{Euklideslemat}. Iloczyn $a_{1} \cdot ... \cdot a_{n}$ mo¿na przedstawiæ w postaci $(a_{1} \cdot ... \cdot a_{n-1})a_{n}$. Wtedy $p \mid (a_{1} \cdot ... \cdot a_{n-1})a_{n}$, czyli z poprzedniego dowodu $p \mid a_{1} \cdot ... \cdot a_{n-1}$ lub $p \mid a_{n}$.
Zasadê t¹ mo¿na uogólniæ dla dowolnego $k$ ($1 \leq k \leq n$). Wtedy $p \mid a_{k} \cdot \prod_{i \neq k}^{n} a_{i}$, a wiêc $p \mid \prod_{i \neq k}^{n} a_{i}$ lub $p \mid a_{k}$.
\end{dowod}

\begin{lemat}
\label{dzieleniekpierwsza}
Jeœli liczby $p, q_{1},...,q_{n} \in \mathbb{P}$ oraz $p \mid q_{1} \cdot ... \cdot q_{n}$, to $p = q_{k}$ dla pewnego $k$, gdzie $1 \leqslant k \leqslant n$.
\end{lemat}

\begin{dowod}
Z Lematu \ref{dzieleniek} wiadomo, ¿e istnieje takie $k$, ¿e $p \mid q_{k}$, ale $q_{k} \in \mathbb{P}$ oraz $p > 1$, sk¹d wynika, ¿e $p = q_{k}$.
\end{dowod}

Trzy powy¿sze lematy to lematy pomocnicze, które pos³u¿¹ do udowodnienia twierdzenia Eulera, mówi¹cego o tym, ¿e liczby pierwsze s¹ czynnikami, na które mo¿na roz³o¿yæ wszystkie z³o¿one liczby naturalne. 

\begin{twierdzenie}(Zasadnicze twierdzenie arytmetyki)
\label{zta}
Ka¿d¹ liczbê naturaln¹ wiêksz¹ od 1, która nie jest liczb¹ pierwsz¹, mo¿na jednoznacznie przedstawiæ w postaci iloczynu liczb pierwszych.
\end{twierdzenie}

\begin{dowod}
Dowód powy¿szego twierdzenia nale¿y podzieliæ na dwie czêœci. Pierwsza dotyczyæ bêdzie istnienia rozk³adu, a druga jego jednoznacznoœci.

\textbf{Istnienie rozk³adu.}
Za³ó¿my, ¿e liczba $n$ jest liczb¹ z³o¿on¹. Wtedy 
$$D = \{d \in N, 1 < d < n, d \mid n\}$$ 
jest niepustym zbiorem dzielników liczby $n$. Niech $p_{1}$ bêdzie najmniejsz¹ liczb¹ zawart¹ w tym zbiorze. Zatem $p_{1}$ jest liczb¹ pierwsz¹, gdy¿ w przeciwnym przypadku istnia³oby $q < p_{1}$ takie, ¿e $q > 1$ i $q \mid p_{1}$, co by³oby sprzeczne z wyborem $p_{1}$. St¹d wynika, ¿e
$$n = p_{1} \cdot n_{1},$$
gdzie $1 < n_{1} < n$. Je¿eli liczba $n_{1} \in \mathbb{P}$, to ¿¹dany rozk³ad zosta³ osi¹gniêty, w~ przeciwnym wypadku rozumowanie nale¿y powtórzyæ dla $n_{1}$, sk¹d dostajemy
$$n = p_{1} \cdot p_{2} \cdot n_{1},$$
gdzie $1 < n_{2} < n_{1}$, $p_{1}, p_{2} \in \mathbb{P}$. Na koniec uzyskuje siê rozk³ad
$$n = p_{1} \cdot ... \cdot p_{k},$$
poniewa¿ $n_{1} > n_{2} > ... > 1$ jest malej¹cym ci¹giem liczb naturalnych, czyli jest ci¹giem skoñczonym.

\textbf{Jednoznacznoœæ rozk³adu.}
Za³ó¿my przeciwnie, ¿e rozk³ad nie jest jednoznaczny, czyli $n = p_{1} \cdot ... \cdot p_{r} = q_{1} \cdot ... \cdot q_{s}$, $(r \leqslant s)$, gdzie $p_{i}$ i $q_{j}$ dla $i=1,2,...,r$ i~ $j=1,2,...,s$ s¹ pierwsze i uporz¹dkowane niemalej¹co.
Poniewa¿ $p_{1} \mid q_{1}...q_{s}$, zatem z Lematu \ref{dzieleniekpierwsza} wynika, ¿e $p_{1}=q_{k}$ dla pewnego $k$, gdzie $1 \leqslant k \leqslant s$, sk¹d wynika, ¿e $p_{1} \geqslant q_{1}$. Analogicznie $q_{1} \mid p_{1}...p_{r}$, wiêc  $q_{1} \geqslant p_{1}$, czyli $p_{1} = q_{1}$. Dziel¹c pocz¹tkow¹ równoœæ przez $p_{1} = q_{1}$ i powtarzaj¹c to samo rozumowanie dla kolejnych czynników obu rozk³adów, otrzymujemy
$$1=q_{r+l} \cdot ... \cdot q_{s},$$
jeœli $r < s$. Jest to sprzeczne dla $q_{r+l},...,q_{s} \in \mathbb{P}$, a wiêc $r = s$ oraz $p_{i} = q_{i}$ dla ka¿dego $i=1,2,...,r$, czyli rozk³ad jest jednoznaczny \cite[\mbox{s.} 10]{marzant}. 
\end{dowod}

Z Zasadniczego Twierdzenia Arytmetyki \ref{zta} wynika bezpoœrednio poni¿szy wniosek.

\begin{wniosek}
Ka¿da liczba naturalna $n > l$ mo¿e byæ jednoznacznie zapisana w postaci kanonicznej 
$$n = p_{1}^{\alpha_{1}} \cdot p_{2}^{\alpha_{2}} \cdot ... \cdot p_{r}^{\alpha_{r}},$$ 
gdzie $p_{i} \in \mathbb{P}$, $\alpha_{i} \in \mathbb{N}$ dla ka¿dego $i=1,2,...,r$ oraz $p_{1} < p_{2} < ... < p_{r}$.
\end{wniosek}

\begin{twierdzenie}(Euklides)
\label{euklides}
Istnieje nieskoñczenie wiele liczb pierwszych.
\end{twierdzenie}

Powsta³o kilkanaœcie dowodów twierdzenia \ref{euklides}. Poni¿ej przedstawiono pierwszy z nich, który zosta³ sformu³owany w IV wieku p.n.e. przez Euklidesa w dziele pod tytu³em \textit{Elementy}. 

\begin{dowod}
Za³ó¿my, ¿e istnieje skoñczony zbiór liczb pierwszych ponumerowanych kolejno $p_{1}, p_{2}, ..., p_{k}$. Rozwa¿my liczbê
$$n=p_{1} p_{2} ...p_{k}+1.$$
Z Twierdzenia \ref{zta} wynika, ¿e $n$ mo¿e byæ liczb¹ pierwsz¹ ró¿n¹ od wszystkich $p_{i}$ lub ma rozk³ad na czynniki pierwsze. Za³ó¿my, ¿e jednym z tych czynników jest $p$. Liczba $n$ przy dzieleniu przez ka¿de z $p_{i}$ daje resztê 1, wiêc $p$ jest ró¿ne od wszystkich $p_{i}$. Z tego wynika, ¿e albo $p$ jest pierwsze lub samo $n$ jest kolejn¹ liczb¹ pierwsz¹, wiêksz¹ od ka¿dego $p_{i}$, co jest sprzeczne z za³o¿eniem \cite[\mbox{s.} 5]{zakrzew}.
\end{dowod}

\section{Sito Eratostenesa i sito Atkina}
\begin{definicja}
\label{sito}
Najprostszym i jednoczeœnie najmniej wydajnym algorytmem wyszukiwania kolejnych liczb pierwszych z przedzia³u $[2,n]$ jest tak zwane \textit{Sito Eratostenesa}, które zosta³o opracowane przez greckiego matematyka Eratostenesa z Cyreny (III-II w. p.n.e.). Algorytm polega na usuwaniu liczb z³o¿onych z zadanego zbioru liczb naturalnych w taki sposób, ¿e ze zbioru wybieramy najmniejsz¹ liczbê i usuwamy wszystkie jej wielokrotnoœci, nastêpnie wybieramy najmniejsz¹ z pozosta³ych i postêpujemy tak jak z pierwsz¹. Na koniec procesu w zbiorze pozostan¹ tylko liczby pierwsze. 
\end{definicja}

\begin{przyklad}
Dla przyk³adu pokazano sito Eratostenesa dla zbioru $P=\{2,3,...,40\}$.
\renewcommand{\theenumi}{\Roman{enumi}}
\begin{enumerate}
\item Usuniêto wszystkie wielokrotnoœci liczby 2.
$$P=\{2,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39\}.$$
\item Usuniêto wszystkie wielokrotnoœci liczby 3.
$$P=\{2,3,5,7,11,13,17,19,23,25,29,31,35,37\}.$$
\item Usuniêto wszystkie wielokrotnoœci liczby 5.
$$P=\{2,3,5,7,11,13,17,19,23,29,31,37\}.$$
Po trzecim kroku w zbiorze $P$ pozosta³y jedynie liczby pierwsze.
\end{enumerate}
\end{przyklad}

Sito Eratostenesa mo¿na teoretycznie zapisaæ w postaci funkcji, na przyk³ad w programie Matlab. Poni¿ej przedstawiono kod programu oraz tabelê z wynikami dla ró¿nych wielkoœci przedzia³ów.

\begin{center}
\lstinputlisting[frame=single]{sitoEratostenesa.m}
\end{center}

\begin{center}
\begin{table}[H] 
\label{toptengreatestprimenumbers}
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & Koniec przedzia³u $\{2,n\}$ &  Czas dzia³ania programu $[s]$ & Iloœæ liczb pierwszych \\ [0.2ex] 
\hline \hline
1 & $\num{100}$ & 0.002345 & 25\\
\hline
2 & $\num{1000}$ & 0.00219 & 168\\
\hline
3 & $\num{10000}$ & 0.107349 & $\num{1229}$\\
\hline
4 & $\num{100000}$ & 0.191775 & $\num{9592}$\\
\hline
5 & $\num{1000000}$ & 0.253845 & $\num{78498}$\\
\hline
6 & $\num{10000000}$ & 6.684239 & $\num{664579}$\\
\hline
7 & $\num{100000000}$ & 174.164354 & $\num{5761455}$\\
\hline
\end{tabular}
\caption{Wyniki dzia³ania funkcji szukaj¹cej liczb pierwszych sitem Eratostenesa.}
\end{table}
\end{center}

Niestety w przypadku wiêkszego zakresu liczb czas oczekiwania na wynik jest bardzo d³ugi. Na przyk³ad przeszukiwanie zbioru liczb naturalnych $[2, \num{1 000 000 000}]$ mo¿e trwaæ ju¿ kilka godzin. Co wiêcej, najwiêksza znana obecnie liczba pierwsza jest o wiele wiêksza od liczb, które mo¿na znaleŸæ za pomoc¹ tego algorytmu nawet na nowoczesnych komputerach o du¿ej wydajnoœci \cite[\mbox{s.} 48-49]{karbowski}.


\begin{definicja}
\textit{Sito Atkina} lub \textit{sito Atkina-Bernsteina} to algorytm autorstwa dwóch matematyków - Arthura Atkina i D.J. Bernsteina, który s³u¿y do wyszukiwania liczb pierwszych w du¿ych przedzia³ach. Metoda ta dzia³a podobnie do sita Eratostenesa, jednak dziêki wykorzystaniu pewnych zale¿noœci jest efektywniejsza i wymaga znacznie mniej pamiêci. Na przyk³ad algorytm ca³kowicie pomija wszystkie liczby podzielne przez 2, 3 lub 5, liczby z parzyst¹ reszt¹ z dzielenia przez 60, liczby, które maj¹ resztê z dzielenia przez 60 podzieln¹ przez 3 oraz liczby z reszt¹ z dzielenia przez 60 podzieln¹ przez 5 \cite{sitoAtkina}.

%Wszystkie liczby n z reszt¹ z dzielenia przez 60 wynosz¹c¹ 1, 13, 17, 29, 37, 41, 49 lub 53 maj¹ resztê z dzielenia przez 4 równ¹ 1. Te liczby s¹ pierwsze wtedy i tylko wtedy, gdy liczba rozwi¹zañ wielomianu 4x2 + y2 = n jest nieparzysta i niepodzielna przez kwadraty liczb ca³kowitych.

%Wszystkie liczby n z reszt¹ z dzielenia przez 60 wynosz¹c¹ 7, 19, 31 lub 43 maj¹ resztê z dzielenia przez 6 równ¹ 1. Te liczby s¹ pierwsze wtedy i tylko wtedy, gdy liczba rozwi¹zañ wielomianu 3x2 + y2 = n jest nieparzysta i niepodzielna przez kwadraty liczb ca³kowitych.

%Wszystkie liczby n z reszt¹ z dzielenia przez 60 wynosz¹c¹ 11, 23, 47 lub 59 maj¹ resztê z dzielenia przez 12 równ¹ 11. Te liczby s¹ pierwsze wtedy i tylko wtedy, gdy liczba rozwi¹zañ wielomianu 3x2 - y2 = n jest nieparzysta i niepodzielna przez kwadraty liczb ca³kowitych.

%¯adna z potencjalnych liczb pierwszych nie jest podzielna przez liczby 2, 3 i 5, wiêc nie mo¿e byæ podzielna równie¿ przez ich kwadraty. Dlatego sprawdzenie czy rozwi¹zania wielomianów nie jest podzielne przez kwadraty liczb ca³kowitych nie zawiera 2^2, 3^2 i 5^2.
\end{definicja}

\section{Spirala Ulama}
\begin{definicja}
\textit{Spirala Ulama} lub \textit{spirala liczb pierwszych} to graficzna metoda przedstawiania rozk³adu liczb pierwszych, która zosta³a przedstawiona w 1963 roku przez polskiego matematyka Stanis³awa Ulama. 
Sposób zapisu polega na tym, ¿e na kwadratowej tablicy zaczynaj¹c od 1 w œrodku spiralnie wypisuje siê kolejne liczby naturalne. Okazuje siê, ¿e na pewnych przek¹tnych liczby pierwsze pojawiaj¹ siê o wiele czêœciej ni¿ na innych. Co wiêcej, zjawisko nie zale¿y od wyboru pierwszej liczby w spirali. Na Rysunku \ref{ulam} przedstawiono spiralê Ulama o rozmiarze $200$x$200$.
\begin{figure}[H]
\label{ulam}
\begin{center}
\includegraphics[scale=0.6]{spirala_ulama.png}
\caption{Spirala Ulama o rozmiarze $200$x$200$ \cite{spiralaulama}.}
\end{center}
\end{figure}
\end{definicja}

\section{Twierdzenie Wilsona i ma³e twierdzenie Fermata}
\begin{definicja}
Niech $n$ bêdzie dowoln¹ liczb¹ naturaln¹. Liczby ca³kowite $a$ i $b$ \textit{przystaj¹ modulo} $n$, je¿eli ich ró¿nica $a-b$ jest podzielna przez $n$. Symbolicznie zapisuje siê to jako
$$a \equiv b \  mod \  n.$$
Zapis ten nazywany jest kongruencj¹ \cite[\mbox{s.} 13]{zakrzew}.
\end{definicja}

\begin{definicja}
Dla ka¿dej liczby naturalnej $m$ zbiór 
$$\phi(m) := \{k : 1 \leq k \leq m,(k,m) = 1 \}$$ 
tworzy \textit{zbiór reszt modulo m}.
\end{definicja}

%notatki TLIEK

\begin{definicja}
\textit{Odwrotnoœci¹ elementu} $a$ \textit{modulo} $n$ jest taki element, oznaczany przez $a^{-1}$, ¿e
$$aa^{-1} \equiv 1 \ mod \ n.$$
Liczba naturalna $a$ jest odwracalna modulo $n$ wtedy i tylko wtedy, gdy $a$ i $n$ s¹ wzglêdnie pierwsze.
\end{definicja}

\begin{twierdzenie}(twierdzenie Wilsona, 1770 r.)
\label{wilson}
Liczba naturalna $p>1$ jest liczb¹ pierwsz¹ wtedy i tylko wtedy, gdy
$$(p-1)!+1 \equiv 0 \ mod \ p.$$
\end{twierdzenie}

\begin{dowod}
Na pocz¹tek nale¿y pokazaæ, ¿e jeœli $p$ jest liczb¹ pierwsz¹, to zachodzi powy¿sza kongruencja. Dla $p=2$ implikacja jest spe³niona, wiêc ograniczono siê do liczb pierwszych nieparzystych.
Poniewa¿ $p$ jest liczb¹ pierwsz¹, wiêc ka¿da z liczb $1,2,3,...,p-2,p-1$ ma swoj¹ odwrotnoœæ modulo $p$. 
Poszukuje siê, dla jakich $a$ spoœród tych liczb zachodzi
$$a \equiv a^{-1} \ mod \ p,$$
tzn. 
$$a^{2} \equiv 1 \ mod \ p.$$
Ostatni warunek oznacza, ¿e liczba $p$ musi dzieliæ
$$a^{2}-1 = (a+1)(a-1).$$
Z Lematu \ref{Euklideslemat} (Euklidesa) wynika, ¿e $p$ dzieli $a+1$ lub $a-1$, wiêc $a=p-1$ lub $a=1$. Te dwie liczby na razie pominiêto. Wówczas liczby $2,3,...,p-2$ dziel¹ siê na pary, liczba i jej odwrotnoœæ modulo $p$, sk¹d wynika, ¿e
$$2 \cdot 3 \cdot ... \cdot (p-2) \equiv 1 \ mod \ p.$$
Mno¿¹c obie strony powy¿szej kongruencji przez $p-1$ otrzymano
$$(p-1)! \equiv p-1 \equiv -1 \ mod \ p,$$
co koñczy dowód pierwszej implikacji.

Teraz wystarczy pokazaæ implikacjê w drug¹ stronê. Nale¿y zatem udowodniæ, ¿e je¿eli $n$ jest liczb¹ z³o¿on¹ to zachodzi
$$(n-1)!+1 \not\equiv 0 \ mod \ n.$$
Jeœli $n$ jest liczb¹ z³o¿on¹, to zachodzi $n=pq$. Za³o¿ono, ¿e $p<q$. Wówczas
$$(n-1)!=1 \cdot 2 \cdot 3 \cdot ... \cdot (p-1) \cdot p \cdot ... \cdot (q-1) \cdot q \cdot ... \cdot (n-1),$$
wiêc $(n-1)!$ jest podzielne przez $n$. St¹d $(n-1)!+1$ nie mo¿e byæ podzielne przez $n$. Wynika st¹d, ¿e
$$(n-1)!+1 \not\equiv 0 \ mod \ n,$$
co koñczy dowód.
\end{dowod}

\begin{twierdzenie}(ma³e twierdzenie Fermata, 1640 r.)
\label{mtf}
Jeœli $p$ jest licz¹ pierwsz¹, to dla ka¿dej liczby ca³kowitej $a$ niepodzielnej przez $p$ zachodzi
$$a^{p-1} \equiv 1 \  mod \  p.$$
\end{twierdzenie}

\begin{dowod}
Jeœli liczba pierwsza $p$ nie dzieli $a$, to ci¹g reszt z dzielenia $a$ przez $p$ $1,2,3,...,p-1$ oraz ci¹g liczb 
\begin{equation}
\label{ciag}
a,2a,3a,...,(p-1)a \ mod \ p
\end{equation}
ró¿ni¹ siê jedynie kolejnoœci¹.
£atwo zauwa¿yæ, ¿e jeœli $p$ nie dzieli $a$, to niemo¿liwe jest, aby $ka \equiv 0 \ mod \ p$ dla $k=1,2,...,p-1$. Z tego wynika, ¿e wszystkie reszty $ka \ mod \ p$ s¹ liczbami naturalnymi od $1$ do $p-1$. Poniewa¿ liczb tych jest dok³adnie $p-1$, wiêc nale¿y pokazaæ, ¿e s¹ one parami ró¿ne.

Za³o¿ono, ¿e dla $i,j<p$, gdzie $i \neq j$ zachodzi $ai \equiv aj \ mod \ p$. Z treœci twierdzenia wiadomo, ¿e $a$ nie jest podzielne przez $p$, wiêc obie strony mo¿na podzieliæ przez $a$, sk¹d otrzymano $i \equiv j \ mod \ p$. Obie liczby s¹ z za³o¿enia mniejsze od $p$, wiêc $i = j$, co prowadzi do sprzecznoœci.

Jak wczeœniej zauwa¿ono, ci¹g liczb \ref{ciag} modulo $p$ to ci¹g $1,2,...,p-1$, wiêc 
$$a \cdot 2a \cdot 3a \cdot ... \cdot (p-1)a \equiv 1 \cdot 2 \cdot 3 \cdot ... \cdot (p-1) \ mod \ p,$$
a po przekszta³ceniu
$$(p-1)!a^{p-1} \equiv (p-1)! \ mod \ p.$$
Z Twierdzenia \ref{wilson} wiadomo, ¿e liczba $(p-1)!$ jest wzglêdnie pierwsza z $p$, wiêc obie strony kongruencji mo¿na podzieliæ przez $(p-1)!$, co koñczy dowód.
\end{dowod}

\begin{definicja}
Je¿eli $n$ jest nieparzyst¹ liczb¹ z³o¿on¹, a liczba $b$, wzglêdnie pierwsza z $n$,  spe³nia warunek 
$$b^{n-1} \equiv 1 \mod n,$$ 
to $n$ jest \textit{liczb¹ pseudopierwsz¹} przy podstawie $b$.
\end{definicja}

\section{W³asnoœci liczb pierwszych}
\begin{twierdzenie}
Istnieje nieskoñczenie wiele liczb pierwszych postaci $4k-1$.
\end{twierdzenie}

\begin{dowod}
Przypuœæmy przeciwnie, ¿e $\{q_{1}, q_{2},..., q_{r}\}$ jest zbiorem wszystkich liczb pierwszych postaci $4k - 1$. Zdefiniujmy $N = 4q_{1}q_{2}...q_{r}-1.$

Poniewa¿ $N$ jest liczb¹ nieparzyst¹, wiêc wszystkie dzielniki liczby $N$ równie¿ s¹ nieparzyste. Z kolei ka¿da liczba nieparzysta ma postaæ $4k-1$ lub $4k+1$. Wiadomo tak¿e, ¿e iloczyn liczb postaci $4k+1$ jest te¿ liczb¹ postaci $4k+1$, wiêc $N$ musi mieæ dzielnik pierwszy $q$ postaci $4k-1$. Jak wiadomo, $q_{1} \nmid N$, $q_{2} \nmid N$, ..., $q_{r} \nmid N$, sk¹d wynika, ¿e $q \notin \{q_{1}, q_{2},..., q_{r}\}$, co jest sprzeczne z za³o¿eniem. 
\end{dowod}

\begin{twierdzenie}
Istnieje nieskoñczenie wiele liczb pierwszych postaci $4k+1$.
\end{twierdzenie}
\
\begin{twierdzenie}(Dirichlet)
Jeœli $m \in \mathbb{N}$, $a \in \mathbb{Z}$ oraz $(a,m)=1$, to w ci¹gu arytmetycznym $a+mk$, gdzie $k=1,2,...$, istnieje nieskoñczenie wiele liczb pierwszych \cite[\mbox{s.} 47]{marzant}.
\end{twierdzenie}

\begin{definicja}
Niech $n \in \mathbb{N}$. Liczbê w postaci
\begin{equation}
\label{liczbaFermata}
F_{n}=2^{2^{n}}+1,
\end{equation}
gdzie $n \geq 1$, nazywa siê \textit{n-t¹ liczb¹ Fermata}.
\end{definicja}

Fermat obliczy³, ¿e $F_{1}=5$, $F_{2}=17$, $F_{3}=2575$, $F_{4}=65537$ s¹ liczbami pierwszymi i za³o¿y³, ¿e ka¿da liczba postaci \ref{liczbaFermata} jest liczb¹ pierwsz¹. Hipotezê t¹ obali³ Euler, który udowodni³, ¿e $F_{5}$ jest podzielne przez $641$.

\begin{definicja}
Liczby pierwsze $p$ i $q=p+2$ nazywane s¹ \textit{liczbami pierwszymi bliŸniaczymi}.
\end{definicja}

Liczbami pierwszymi bliŸniaczymi s¹ np.: (3, 5), (11, 13), (1949, 1951), (4967, 4969). Najwiêksze znane dziœ liczby bliŸniacze, ka¿da sk³adaj¹ca siê z 200 700 cyfr, to 
$$\num{3756801695685} \cdot 2^{\num{666669}} \pm 1,$$ 
znalezione w 2011 roku \cite{lpb}.

\begin{definicja}
\textit{Liczba pierwsza Sophie Germain} to dowolna liczba pierwsza $p$, dla której liczba $2p+1$ tak¿e jest liczb¹ pierwsz¹ (np. 23, gdy¿ $2 \cdot 23 +1 = 47$).
\end{definicja}

Najwiêksz¹ znan¹ obecnie liczb¹ pierwsz¹ Sophie Germain jest 
$$\num{18543637900515} \cdot 2^{\num{666667}}-1,$$ a jej zapis dziesiêtny wymaga 200701 cyfr. Zosta³a ona odkryta w 2012 przez Philipa Bliedunga.

\begin{definicja}
\textit{Liczbami Mersenne'a} s¹ liczby postaci $M_{n}=2^{n}-1$, $n \geq 1$. Je¿eli liczba Mersenne'a jest pierwsza to nazywa siê \textit{liczb¹ pierwsz¹ Mersenne'a}.
\end{definicja}

Nie wiadomo, czy istnieje nieskoñczenie wiele liczb pierwszych Mersenne'a. Do 2017 roku znanych ich 49. Co wiêcej, dziesiêæ najwiêkszych odkrytych do tej pory liczb pierwszych to w³aœnie liczby Mersenne'a. Zosta³y one przedstawione w Tabeli \ref{toptengreatestprimenumbers}. Ich poszukiwaniem zajmuje siê projekt GIMPS (ang. Great Internet Mersenne Prime Search), w którym mog¹ wzi¹æ udzia³ ochotnicy z ca³ego œwiata.


\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Nr & Liczba pierwsza &  Liczba cyfr & Data odkrycia & Odkrywcy \\ [0.2ex] 
\hline \hline
1 & $2^{\num{74 207 281}}-1$ & 22 338 618 & 2016-01-07 & Cooper, GIMPS\\
\hline
2 & $2^{\num{57 885 161}}-1$ & 17 425 170 & 2013-01-25 & Cooper, GIMPS\\
\hline
3 & $2^{\num{43 112 609}}-1$ & 12 978 189 & 2008-08-23 & Edson Smith, GIMPS\\
\hline
4 & $2^{\num{42 643 801}}-1$ & 12 837 064 & 2009-06-04 & Strindmo, GIMPS\\
\hline
5 & $2^{\num{37 156 667}}-1$ & 11 185 272 & 2008-09-06 & H. Elvenich, GIMPS\\
\hline
6 & $2^{\num{32 582 657}}-1$ & 9 808 358 & 2006-09-04 & Boone, Cooper, GIMPS\\
\hline
7 & $2^{\num{30 402 457}}-1$ & 9 152 052 & 2005-12-15 & Boone, Cooper, GIMPS\\
\hline
8 & $2^{\num{25 964 951}}-1$ & 7 816 230 & 2005-02-18 & Nowak, GIMPS\\
\hline
9 & $2^{\num{24 036 583}}-1$ & 7 235 733 & 2004-05-15 & Findley, GIMPS\\
\hline
10 & $2^{\num{20 996 011}}-1$ & 6 320 430 & 2003-11-17 & Michael Shafer, GIMPS\\
\hline
\end{tabular}
\caption{Dziesiêæ najwiêkszych znanych liczb pierwszych na 2017 rok \cite{gimps}.}
\label{toptengreatestprimenumbers}
\end{center}
\end{table}

\section{Funkcja Eulera i "porz¹dek mno¿¹cy"}
\begin{definicja}
\textit{Funkcja $\varphi$ (Eulera)} lub tocjent to funkcja, która ka¿dej liczbie naturalnej przypisuje liczbê liczb wzglêdnie pierwszych z ni¹ i nie wiêkszych od niej.
Jeœli $n=p_{1}^{m_{1}} \cdot ... \cdot p_{k}^{m_{k}}$ jest rozk³adem liczby $n \in \mathbb{N}$ na czynniki pierwsze (gdzie $p_{i} \neq p_{j}$ dla ró¿nych $i,j \in K=\{1,2,...,k\}$), to wtedy
$$\varphi(n)=\prod_{i \in K} \left(1-\frac{1}{p_{i}}\right).$$
\end{definicja}

Funkcja Eulera jest bardzo prosta do zaimplementowania w œrodowisku Matlab, co zosta³o przedstawione poni¿ej.

\begin{center}
\lstinputlisting[frame=single]{euler_phi.m}
\end{center}

Poni¿ej przedstawiono tabelê z wynikami i czasem dzia³ania powy¿szej funkcji dla liczb o ró¿nej wielkoœci.


\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Wartoœæ funkcji $\varphi(n)$ &  Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline
1 & $23$ & $22$ & $0.023398$\\
\hline
2 & $100$ & $40$ & $0.029472$\\
\hline
3 & $567$ & $324$ & $0.047793$\\
\hline
4 & $1000$ & $400$ & $0.051363$\\
\hline
5 & $12345$ & $6576$ & $0.496064$\\
\hline
6 & $123456$ & $41088$ & $5.326313$\\
\hline
7 & $1234567$ & $1224720$ & $65.953887$\\
\hline
\end{tabular}
\caption{Wartoœæ funkcji $\varphi(n)$ dla liczb o ró¿nej wielkoœci.}
\end{center}
\end{table}

\begin{definicja}
W teorii liczb, dla danej liczby ca³kowitej $a$ i dodatniej liczby ca³kowitej $n$, gdzie $NWD(a,n)=1$, \textit{porz¹dkiem mno¿¹cym (ang. multiplicative order)} modulo $n$ jest najmniejsza ca³kowita liczba dodatnia $k$, dla której zachodzi
$$a^{k} \equiv 1 \ mod \ n.$$
Porz¹dek modulo $n$ oznacza siê $ord_{n}(a)$ lub $o_{n}(a)$ \cite{multord}. 
\end{definicja}

\textit{Multiplicative order} jest równie¿ bardzo prosty do zaimplementowania w œrodowisku Matlab, a kod tej funkcji zosta³ przedstawiony poni¿ej.

\begin{center}
\lstinputlisting[frame=single]{mult_order.m}
\end{center}

Poni¿ej przedstawiono tabelê z wynikami i czasem dzia³ania powy¿szej funkcji.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & Liczba $n$ & Liczba $a$ & Wartoœæ funkcji $o_{n}(a)$ &  Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline
1 & $7$ & $4$ & $3$ & $0.033575$\\
\hline

2 & $4$ & $7$ & $2$ & $0.025657$\\
\hline

3 & $100$ & $387$ & $20$ & $0.031364$\\
\hline

4 & $167$ & $379$ & $166$ & $0.036658$\\
\hline

5 & $1000$ & $37$ & $100$ & $0.035297$\\
\hline
\end{tabular}
\caption{Wartoœæ funkcji  $o_{n}(a)$ dla liczb o ró¿nej wielkoœci.}
\end{center}
\end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%
%%%%%%%%
%%%%%%%%      D R U G I    R O Z D Z I A £
%%%%%%%%
%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Testy pierwszoœci liczb}
\begin{definicja}
\textit{Test pierwszoœci} jest to algorytm, który okreœla, czy zadana liczba jest liczb¹ pierwsz¹, czy z³o¿on¹. 
\end{definicja}

Poni¿szy rozdzia³ ma na celu przedstawienie algorytmów, które testuj¹ pierwszoœæ zadanej liczby. 

\section{Testy deterministyczne}
\textbf{Testy deterministyczne} to testy, które wydaj¹ certyfikat pierwszoœci, czyli ich wynik jest prawid³owy z prawdopodobieñstwem 1. Zwracaj¹ odpowiedŸ, ¿e podana na wejœciu liczba $n$ jest pierwsza wtedy i tylko wtedy, gdy naprawdê tak jest, czyli wynik dzia³ania testu jest jednoznaczny.

\subsection{Metoda naiwna}
Najprostsz¹ deterministyczn¹ metod¹ testowania pierwszoœci jest \textit{metoda naiwna}. Algorytm dzia³ania jest bardzo prosty: dla danej liczby $n>2$ wystarczy sprawdziæ, czy dzieli siê ona kolejno przez $2,3,...,n-1$. Je¿eli wœród tych liczb nie ma dzielnika liczby $n$, wtedy $n$ jest pierwsza. Jeœli chocia¿ przez jedn¹ z tych liczb $n$ dzieli siê bez reszty, wtedy $n$ jest z³o¿ona.
 
Jak siê okazuje, nie trzeba testowaæ podzielnoœci przez wszystkie liczby od $2$ do $n-1$, wystarczy ograniczyæ siê do przedzia³u $2,3,...,\sqrt{n}$.

Co wiêcej, algorytm mo¿na ulepszyæ dziel¹c liczbê $n$ jedynie przez wszystkie liczby pierwsze mniejsze lub równe $\sqrt{n}$. Listê takich liczb mo¿emy wyznaczyæ sitem Eratostenesa \ref{sito}. 

Warto zauwa¿yæ, ¿e jeœli liczba $n$ oka¿e siê byæ z³o¿ona, to jednoczeœnie wyznaczany jest jej nietrywialny dzielnik.

Algorytm metody naiwnej w wersji udoskonalonej dzia³a nastêpuj¹co:
\begin{enumerate}
\item Pobierz liczbê $n$.
\item Wyznacz zbiór $p$ wszystkich liczb pierwszych mniejszych lub równych $n$.
\item Dziel liczbê $n$ przez kolejne liczby ze zbioru $p$.
\item Jeœli $n$ dzieli siê przez przynajmniej jedn¹ z liczb ze zbioru $p$ bez reszty, wtedy $n$ jest z³o¿ona.
\item Jeœli wœród liczb $p$ nie ma dzielnika liczby $n$, wtedy $n$ jest z³o¿ona.
\end{enumerate}

Jest to algorytm deterministyczny, który uznaje pierwszoœæ liczby ze stuprocentow¹ pewnoœci¹. W zwi¹zku z tym, ¿e metoda jest bardzo dok³adna, wymaga a¿ $O(\sqrt{n}\lg^2{n})$ kroków, wiêc jej efektywnoœæ spada dla bardzo du¿ych liczb.

Algorytm metody naiwnej w programie Matlab zosta³ przedstawiony poni¿ej.

\begin{center}
\lstinputlisting[frame=single]{MetodaNaiwna.m}
\end{center}

Tabela \ref{metodanaiwnatabela} przedstawia wyniki i czas dzia³ania algorytmu dla liczb o ró¿nej wielkoœci. 

\begin{center}
\begin{table}[H] 
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Testowana liczba & Czas dzia³ania programu $[s]$ & Liczba pierwsza/z³o¿ona \\ [0.2ex] 
\hline \hline
1 & 7 & 0.005050 & pierwsza\\
\hline
2 & 23 & 0.004529 & pierwsza\\
\hline
3 & 365 & 0.002450 & z³o¿ona\\
\hline
4 & 5737 & 0.002264 & pierwsza\\
\hline
5 & 99487 & 0.015185 & pierwsza\\
\hline
6 & 99489 & 0.014734 & z³o¿ona\\
\hline
7 & 100001 & 0.013290 & z³o¿ona\\
\hline
8 & 12192109 & 9.409341 & pierwsza\\
\hline
9 & 14476001 & 11.304216 & pierwsza\\
\hline
10 & 100000001 & 215.084406 & z³o¿ona\\
\hline
\end{tabular}
\caption{Wyniki dzia³ania funkcji testuj¹cej pierwszoœæ liczb metod¹ naiwn¹ z sitem Eratostenesa.}
\label{metodanaiwnatabela}
\end{table}
\end{center}
£atwo zauwa¿yæ, ¿e dla niewielkich liczb czas dzia³ania jest bardzo krótki, ale dla liczb rzêdu $10^{8}$ sprawdzanie pierwszoœci trwa ju¿ kilka minut.

\subsection{Test pierwszoœci AKS}
\textit{Test pierwszoœci AKS} (lub inaczej test pierwszoœci Agrawal-Kayal-Saxena lub cyklotomiczny test AKS) jest deterministycznym testem pierwszoœci liczb opracowanym przez trójkê indyjskich naukowców - Manindra Agrawala, Neeraja Kayala i~ Nitina Saxena z Indyjskiego Instytutu Technologii w Kanpurze. Test zosta³ po raz pierwszy opublikowany 6 sierpnia 2002 roku w artykule zatytu³owanym \textit{PRIMES is in P}. W 2006 roku autorzy otrzymali za to odkrycie dwie nagrody - Nagrodê Gödla, któr¹ przyznaje siê za osi¹gniêcia w dziedzinie informatyki teoretycznej, oraz nagrodê Fulkersona, przyznawan¹ za wybitne prace z zakresu matematyki dyskretnej.

Test AKS jest pierwszym opublikowanym algorytmem testuj¹cym czy dana liczba jest pierwsza, który jest jednoczeœnie szybki, jednoznaczny i~ bezwarunkowy. Oznacza to, ¿e algorytm ten zawsze zwróci poprawn¹ odpowiedŸ (w przeciwieñstwie do testów probabilistycznych), a jego dzia³anie nie bazuje na ¿adnych nieudowodnionych hipotezach.

Test pierwszoœci AKS opiera siê na pewnej to¿samoœci liczb pierwszych, która jest uogólnieniem ma³ego twierdzenia Fermata \ref{mtf}.

\begin{lemat}(ma³e twierdzenie Fermata dla wielomianów)
\label{lematAKStresc}
Niech $a, n \in \mathbb{N}$ i $n \geq 2$ oraz $(a,n)=1$. Wówczas $n$ jest liczb¹ pierwsz¹ wtedy i tylko wtedy, gdy
\begin{equation}
\label{lematAKS}
(X+a)^{n}=X^{n}+a \ mod \ n.
\end{equation}
\end{lemat}

\begin{dowod}
Równanie \ref{lematAKS} mo¿na zapisaæ w postaci
$$(X+a)^{n}-(X^{n}+a)=0 \ mod \ n.$$

Dla $0 \leq i \leq n$ wspó³czynnik przy $X^{i}$ w wyra¿eniu $((X+a)^{n}-(X^{n}+a))$ wynosi ${n}\choose{i}$ $a^{n-i}$. 

Za³ó¿my, ¿e $n$ jest liczb¹ pierwsz¹. Wtedy ${n}\choose{i}$ $=0 \ mod \ n$, a wiêc wszystkie wspó³czynniki s¹ zerowe.

Za³ó¿my, ¿e $n$ jest liczb¹ z³o¿on¹. Rozwa¿my liczbê pierwsz¹ $q$, która jest dzielnikiem $n$ i dla pewnego $k$ niech $q^{k} \mid n$. Wtedy $q^{k}$ nie dzieli ${n}\choose{q}$ i jest wzglêdnie pierwsza z $a^{n-q}$. St¹d wspó³czynnik przy $X^{q}$ jest niezerowy (mod $n$). Zatem wyra¿enie $((X+a)^{n}-(X^{n}+a))$ nie jest to¿samoœciowo równe zero (mod $n$).
\end{dowod}

Powy¿sza to¿samoœæ sugeruje prosty test pierwszoœci: pobieramy badane $n$, wybieramy $a$ i sprawdzamy, czy kongruencja \ref{lematAKS} jest spe³niona. Jednak wymaga to czasu, poniewa¿ w najgorszym przypadku nale¿y oszacowaæ $n$ wspó³czynników po lewej stronie równania. Prostym sposobem na zmniejszenie liczby tych wspó³czynników jest oszacowanie obu stron kongruencji \ref{lematAKS} modulo wielomian postaci $X^{r}-1$ dla odpowiednio wybranego ma³ego $r$. Innymi s³owy, sprawdziæ, czy spe³nione jest równanie
\begin{equation}
\label{lematAKSnowe}
(X+a)^{n}=X^{n}+a \ (mod \ X^{r}-1,n).
\end{equation}
Z Lematu \ref{lematAKStresc} wynika natychmiast, ¿e wszystkie liczby pierwsze $n$ spe³niaj¹ równanie \ref{lematAKSnowe} dla wszystkich wartoœci $a$ i $r$. Problem polega na tym, ¿e niektóre liczby z³o¿one $n$ mog¹ równie¿ spe³niæ równanie dla kilku wartoœci $a$ i $r$. Jednak mo¿emy pokazaæ, ¿e dla odpowiednio dobranego $r$, jeœli równanie \ref{lematAKSnowe} jest spe³nione dla kilku $a$, to $n$ musi byæ potêg¹ liczby pierwszej \cite{aks}.

Algorytm dzia³ania metody AKS jest nastêpuj¹cy:
\begin{enumerate}
\item Wybierz testowan¹ liczbê $n>1$.
\item Jeœli istnieje takie $a \in \mathbb{N}$ i $b>1$, ¿e $n=a^{b}$, to liczba $n$ jest z³o¿ona - stop.
\item ZnajdŸ najmniejsze $r$ takie, ¿e $o_{r}(n)>(log_{2} n)^{2}$.
\item Jeœli $1 < NWD(a,n) < n$ dla pewnego $a \leq r$, wtedy $n$ jest z³o¿ona - stop.
\item Jeœli $n \leq t$, $n$ jest pierwsza - stop.
\item Dla $a=1$ do $\lfloor \sqrt{\varphi(r)}log_{2} n \rfloor$ rób \\
jeœli $((X+a)^{n} \neq X^{n}+a \ (mod \ X^{r}-1,n))$, $n$ jest z³o¿ona - stop.
\item $n$ jest pierwsza.
\end{enumerate}


Poni¿ej przedstawiono kod metody AKS zaimplementowany w œrodowisku Matlab.

\begin{center}
\lstinputlisting[frame=single]{MetodaAKS.m}
\end{center}

Tabela poni¿ej przedstawia wyniki i czas dzia³ania testu pierwszoœci AKS.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Pierwsza/z³o¿ona &  Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline
1 & $3$ & pierwsza & $0.034859$\\
\hline

2 & $23$ & pierwsza & $0.047291$\\
\hline

3 & $25$ & z³o¿ona & $0.009026$\\
\hline

4 & $123$ & z³o¿ona & $0.045841$\\
\hline

5 & $199$ & pierwsza & $4.284376$\\
\hline

6 & $1000$ & z³o¿ona & $0.020794$\\
\hline

7 & $1001$ & z³o¿ona & $0.047622$\\
\hline

8 & $1223$ & pierwsza & $35.298198$\\
\hline

9 & $3313$ & pierwsza & $113.642901$\\
\hline

10 & $3315$ & z³o¿ona & $0.044053$\\
\hline

\end{tabular}
\caption{Wartoœæ funkcji $\varphi(n)$ dla liczb o ró¿nej wielkoœci.}
\end{center}
\end{table}

£atwo zauwa¿yæ, ¿e algorytm radzi sobie bardzo szybko z liczbami z³o¿onymi i~ niewielkimi liczbami pierwszymi, jednak ju¿ dla liczb pierwszych czterocyfrowych potrzebne jest ponad pó³ minuty na potwierdzenie ich pierwszoœci. Test AKS ma niestety znikom¹ wartoœæ praktyczn¹, poniewa¿ z³o¿onoœæ tego algorytmu jest du¿a, a to oznacza, ¿e liczba wykonywanych operacji roœnie bardzo szybko wraz ze wzrostem wielkoœci badanej liczby.  

%\subsection{Algorytm Millera}
%nie ma w internecie :(

\section{Testy probabilistyczne}
\textit{Testy probabilistyczne} (znane tak¿e jako testy randomizacyjne) s¹ obecnie najczêœciej stosowanymi i najbardziej efektywnymi testami pierwszoœci liczb, które w swoim dzia³aniu u¿ywaj¹ losowoœci. Wykorzystuje siê w nich losowo wygenerowane liczby z zadanego przedzia³u. Zale¿noœæ od takich elementów powoduje, ¿e algorytm mo¿e daæ b³êdny wynik testu pierwszoœci, lecz prawdopodobieñstwo takiego zdarzenia jest bardzo ma³e.

\subsection{Test pierwszoœci Fermata}
Zgodnie z ma³ym twierdzeniem Fermata \ref{mtf} dla liczb pierwszych $p$ zachodzi kongruencja
\begin{equation}
\label{mtfw}
a^{p-1} \equiv 1 \ mod \ p.
\end{equation}

\textit{Test pierwszoœci Fermata} to probabilistyczny test pierwszoœci, który opiera siê na za³o¿eniu, ¿e zachodzi wynikanie odwrotne do Twierdzenia \ref{mtf}, czyli jeœli prawdziwa jest kongruencja \ref{mtfw}, to liczba $p$ jest pierwsza z du¿ym prawdopodobieñstwem.

Algorytm testu pierwszoœci Fermata dla zadanej liczby $p$ wygl¹da nastêpuj¹co:
\begin{enumerate}
\item Wylosuj $a \in [2,p-2]$.
\item Oblicz $d = NWD(a,p)$. Jeœli $d>1$ to $p$ jest liczb¹ z³o¿on¹.
\item SprawdŸ zachodzenie kongruencji $a^{p-1} \equiv 1 \ mod \ p$.
\item Jeœli zachodzi, to $p$ mo¿e byæ liczb¹ pierwsz¹, w innym przypadku $p$ jest liczb¹ z³o¿on¹.
\end{enumerate}

Przy kilkukrotnym powtórzeniu losowania dla ró¿nych liczb test Fermata daje bardzo wiarygodny wynik. 

Poni¿ej przedstawiona zosta³a implementacja testu pierwszoœci Fermata w programie Matlab.

\begin{center}
\lstinputlisting[frame=single]{testFermata.m}
\end{center}

Tabela \ref{tabelaFermat} przedstawia wyniki dzia³ania powy¿szego kodu dla ró¿nych liczb pierwszych i z³o¿onych oraz czas dzia³ania algorytmu.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & Liczba $p$ & Liczba powtórzeñ $n$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & $2$ & pierwsza $(100\%)$ & $0.069366$ \\
\hline

2 & $15$ & $8$ & z³o¿ona $(100\%)$ & $0.097156$ \\
\hline

3 & $47$ & $18$ & pierwsza $(100\%)$  & $0.102425$\\
\hline

4 & $199$ & $28$ & pierwsza $(100\%)$  & $0.090658$\\
\hline

5 & $1999$ & $68$ & pierwsza $(100\%)$ & $0.092615$\\
\hline

6 & $6899$ & $190$ & pierwsza $(100\%)$ & $0.095254$\\
\hline

7 & $94427$ & $19$ & pierwsza $(100\%)$ & $0.080347$\\
\hline

8 & $94428$ & $19$ & z³o¿ona $(100\%)$ & $0.070723$\\
\hline

9 & $15472147$ & $30$ & pierwsza $(100\%)$ & $0.071718$\\
\hline

10 & $15472147$ & $5530$ & pierwsza $(100\%)$ & $0.733975$\\
\hline

11 & $15472148$ & $5530$ & z³o¿ona $(100\%)$ & $0.575719$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Fermata dla liczb o ró¿nej wielkoœci.}
\label{tabelaFermat}
\end{center}
\end{table}

£atwo zauwa¿yæ, ¿e algorytm dzia³a niezwykle szybko i zwraca stuprocentowo pewny wynik nawet dla bardzo du¿ych liczb. Czas dzia³ania zale¿y g³ównie od wyboru liczby powtórzeñ $n$ - im liczba $n$ jest wiêksza, tym czas dzia³ania algorytmu siê wyd³u¿a. Jednak ju¿ dla niewielkich $n$ wynik jest podawany z prawdopodobieñstwem równym $1$.   

Trzeba zaznaczyæ, ¿e kongruencja \ref{mtfw} mo¿e zachodziæ tak¿e w pewnych przypadkach, gdy $p$ nie jest liczb¹ pierwsz¹. Liczby te omówione zosta³y poni¿ej \cite[\mbox{s.} 49]{zakrzew}.

\begin{definicja}
\textit{Liczby Carmichaela} to z³o¿one liczby naturalne, dla których teza ma³ego twierdzenia Fermata \ref{mtf} jest prawdziwa. Liczba naturalna $n$ jest liczb¹ Carmichaela wtedy i tylko wtedy, gdy jest liczb¹ z³o¿on¹ i dla ka¿dej liczby naturalnej $a$ z przedzia³u $1 < a < n$, wzglêdnie pierwszej z $n$, liczba $a^{n-1}-1$ jest podzielna przez $n$ \cite{liczbaCarm}.
\end{definicja}

Najmniejsz¹ liczb¹ Carmichaela jest $561 = 3 \cdot 11 \cdot 17$. Innymi z nich s¹ na przyk³ad $1105 = 5 \cdot 13 \cdot 17$, $1729 = 7 \cdot 13 \cdot 19$ lub $2465 = 5 \cdot 17 \cdot 29$.

Test Fermata zastosowany do liczby Carmichaela jest nieskuteczny, co pokazuje Tabela \ref{tabelaFermatCarm}.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|c|}
\hline
Lp. & L. Carmichaela & Liczba powtórzeñ $n$ & Wynik & Czas dzia³ania $[s]$ \\ [0.2ex] 
\hline \hline

1 & $561$ & $5$ & pierwsza $(60\%)$ & $0.064905$ \\
\hline

2 & $561$ & $15$ & pierwsza $(73\%)$ & $0.097156$ \\
\hline

3 & $561$ & $150$ & pierwsza $(58\%)$  & $0.102425$\\
\hline

4 & $1105$ & $5$ & pierwsza $(100\%)$  & $0.067776$\\
\hline

5 & $1105$ & $15$ & pierwsza $(73\%)$ & $0.068222$\\
\hline

6 & $1105$ & $150$ & pierwsza $(70.6\%)$ & $0.088589$\\
\hline

7 & $1729$ & $5$ & pierwsza $(60\%)$ & $0.069128$\\
\hline

8 & $1729$ & $15$ & z³o¿ona $(66.67\%)$ & $0.078923$\\
\hline

9 & $1729$ & $150$ & pierwsza $(76.67\%)$ & $0.082983$\\
\hline

10 & $2465$ & $5$ & pierwsza $(80\%)$ & $0.064879$\\
\hline

11 & $2465$ & $15$ & pierwsza $(60\%)$ & $0.070719$\\
\hline

12 & $2465$ & $150$ & pierwsza $(75.3\%)$ & $0.090890$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Fermata dla liczb Carmichaela.}
\label{tabelaFermatCarm}
\end{center}
\end{table}

Jak wynika z powy¿szej tabeli, liczby Carmichaela przechodz¹ test pierwszoœci Fermata z du¿ym prawdopodobieñstwem.

\subsection{Test pierwszoœci Lehmana}
Test Lehmana jest kolejnym testem probabilistycznym pierwszoœci liczb. Algorytm testu Lehmana dla du¿ej liczby $p$ wygl¹da nastêpuj¹co:
\begin{enumerate}
\item Wylosuj du¿¹ liczbê $a < p$.
\item Oblicz $b=a^{(p-1)/2} \ mod \ p$.
\item Jeœli $b \equiv 1 \ mod \ p$ lub $b \equiv -1 \ mod \ p$ to $p$ jest liczb¹ pierwsz¹ z prawdopodobieñstwem wiêkszym lub równym $50\%$. W przeciwnym wypadku $p$ jest liczb¹ z³o¿on¹ \cite[\mbox{s.} 60]{karbowski}. 
\end{enumerate}

Poni¿szy skrypt przedstawia algorytm Lehmana w programie Matlab.

\begin{center}
\lstinputlisting[frame=single]{testLehmana.m}
\end{center}

Wyniki dzia³ania programu przedstawione zosta³y w Tabeli \ref{tabelaLehman}.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $p$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & pierwsza $(\geq 50\%)$ & $0.023871$ \\
\hline

2 & $47$ & pierwsza $(\geq 50\%)$ & $0.032829$ \\
\hline

3 & $199$ & pierwsza $(\geq 50\%)$  & $0.031084$\\
\hline

4 & $1999$ & pierwsza $(\geq 50\%)$ & $0.026158$ \\
\hline

5 & $6899$ & pierwsza $(\geq 50\%)$ & $0.029798$\\
\hline

6 & $94427$ & pierwsza $(\geq 50\%)$ & $0.023563$ \\
\hline

7 & $94428$ & z³o¿ona $(100\%)$ & $0.015226$\\
\hline

8 & $15472145$ & z³o¿ona $(100\%)$ & $0.027043$\\
\hline

9 & $15472147$ & pierwsza $(\geq 50\%)$ & $0.026316$\\
\hline

10 & $15485857$ & pierwsza $(\geq 50\%)$ & $0.024070$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Lehmana dla liczb o ró¿nej wielkoœci.}
\label{tabelaLehman}
\end{center}
\end{table}

Algorytm Lehmana jest bardzo szybki i zwraca prawid³owe wyniki dla liczb o ró¿nej wielkoœci.

\subsection{Test pierwszoœci Solovaya-Strassena}
Kolejnym probabilistycznym testem pierwszoœci jest test Solovaya-Strassena, opracowany przez dwóch matematyków - amerykañskiego profesora Roberta M. Solovaya i profesora Volkera Strassena z Niemiec. Do wprowadzenia algorytmu testowania niezbêdna jest definicja symbolu Legendre’a.

\begin{definicja}
Niech $p$ bêdzie liczb¹ pierwsz¹ wiêksz¹ od 2, a $a$ liczb¹ ca³kowit¹. \textit{Symbol Legendre'a} $\left( \frac{a}{p} \right)$ definiuje siê nastêpuj¹co

$$
\left( \frac{a}{p} \right)= \left\{ \begin{array}{ll}
0, \textrm{ jeœli $a$ jest wielokrotnoœci¹ liczby $p$},\\
1, \textrm{jeœli istnieje $b$ takie, ¿e $b^{2}=a \ mod \ p$},\\
-1, \textrm{jeœli nie istnieje ¿adne $b$ takie, ¿e $b^{2}=a \ mod \ p$}.
\end{array} \right.
$$

Symbol Legendre'a mo¿na obliczyæ nastêpuj¹cym wzorem
$$\left( \frac{a}{p} \right) \equiv a^{\frac{p-1}{2}}\mod p.$$
\end{definicja}

Symbol Legendre'a mo¿e byæ uogólniony do \textit{symbolu Jacobiego} $\left(\frac {a}{n}\right)$, gdzie $n$ jest dowoln¹ liczb¹ nieparzyst¹, która ma rozk³ad na czynniki pierwsze 
$$n=p_{1}^{m_{1}} \cdot p_{2}^{m_{2}} \cdot ... \cdot p_{k}^{m_{k}}.$$
Wtedy symbol Jacobiego mo¿na zapisaæ w postaci
$$\left(\frac {a}{n}\right)=\left(\frac {a}{p_{1}}\right)^{m_{1}} \cdot \left(\frac {a}{p_{2}}\right)^{m_{2}} \cdot ... \cdot \left(\frac {a}{p_{k}}\right)^{m_{k}}.$$
Je¿eli $n$ jest liczb¹ pierwsz¹ to symbol Jacobiego i symbol Legendre'a s¹ sobie równe.

\begin{definicja}
Jeœli $n$ jest liczb¹ z³o¿on¹ nieparzyst¹, a liczba $b$, wzglêdnie pierwsza z $n$, spe³nia warunek
\begin{equation}
b^{\frac{n-1}{2}} \equiv \left( \frac{b}{n} \right) \mod n,
\end{equation}
to $n$ jest \textit{pseudopierwsz¹ liczb¹ Eulera} przy podstawie $b$.
\end{definicja}

Test pierwszoœci liczby $n$ algorytmem Solovaya-Strassena przebiega nastêpuj¹co
\begin{enumerate}
\item Losujemy $b \in \{2,...,n-2\}$.
\item Obliczamy $r = b^{\frac{n-1}{2}} \mod n$. Jeœli $r \neq \pm 1$, to $n$ jest liczb¹ z³o¿on¹.
\item Obliczamy $s = \left( \frac{b}{n} \right)$. Jeœli $r \neq s$, to $n$ jest z³o¿ona.
\end{enumerate} 

Je¿eli po zakoñczeniu algorytmu nie ma odpowiedzi "n jest z³o¿ona", to test nale¿y powtórzyæ. Po $k$-krotnym powtórzeniu testu i stwierdzeniu, ¿e $n$ jest liczb¹ pseudopierwsz¹ Eulera przy ka¿dej z wybranych podstaw $b$, prawdopodobieñstwo, ¿e liczba $n$ jest jednak z³o¿ona wynosi $\frac{1}{2^{k}}$.

%bibliografia - notatki z wykladu Teoria Liczb i elementy kryptografii

Skrypt jednorazowego przejœcia algorytmu testu pierwszoœci Solovaya-Strassena w programie Matlab zosta³ przedstawiony poni¿ej.

\begin{center}
\lstinputlisting[frame=single]{testSolovaya.m}
\end{center}

Tabela \ref{tabelaSS} przedstawia wyniki otrzymane za pomoc¹ powy¿szego algorytmu i czas dzia³ania funkcji dla ka¿dej operacji.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & pierwsza & $0.034387$ \\
\hline

2 & $47$ & pierwsza & $0.032534$ \\
\hline

3 & $199$ & pierwsza & $0.039209$\\
\hline

4 & $1999$ & pierwsza & $0.032661$ \\
\hline

5 & $6899$ & pierwsza & $0.036613$\\
\hline

6 & $94427$ & pierwsza & $0.034677$ \\
\hline

7 & $94428$ & z³o¿ona & $0.017758$\\
\hline

8 & $15472145$ & z³o¿ona & $0.027369$\\
\hline

9 & $15472147$ & pierwsza & $0.056256$\\
\hline

10 & $15485857$ & pierwsza & $0.033962$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Solovaya-Strassena dla liczb o ró¿nej wielkoœci.}
\label{tabelaSS}
\end{center}
\end{table}

\subsection{Test pierwszoœci Millera-Rabina}
\textit{Test pierwszoœci Millera-Rabina} jest kolejnym testem probabilistycznym, który z pewnym prawdopodobieñstwem okreœla, czy dana liczba jest pierwsza, czy z³o¿ona. Oryginalna wersja tego testu, stworzona przez profesora Gary'ego L. Millera, jest testem deterministycznym, lecz jego prawid³owoœæ bazuje na uogólnionej hipotezie Riemanna, która nie zosta³a dotychczas udowodniona. W 1975 roku kryptolog Michael O. Rabin przekszta³ci³ algorytm Millera do algorytmu probabilistycznego.

\begin{fakt}
Niech $n$ bêdzie nieparzyst¹ liczb¹ pierwsz¹ i niech $n-1=2^{s} \cdot t$, gdzie $2 \nmid t$. Niech $b \in \phi(n)$. Wtedy albo $b^{t} \equiv 1$ (mod $n$), albo $b^{2^{r}t} \equiv -1$ (mod $n$) dla pewnego $r \in \{0,1,...,s-1\}$.  
\end{fakt}

\begin{definicja}
Niech $n$ bêdzie nieparzyst¹ liczb¹ z³o¿on¹ i niech $n-1=2^{s} \cdot t$, gdzie $2 \nmid t$. Niech $b \in \phi(n)$. Je¿eli
\begin{itemize}
\item $b^{t} \equiv 1$ (mod $n$) lub
\item $b^{2^{r}t} \equiv -1$ (mod $n$) dla pewnego $r \in \{0,1,...,s-1\}$
\end{itemize}
to liczbê $n$ nazywamy \textit{liczb¹ silnie pseudopierwsz¹} przy podstawie $b$. 
\end{definicja}

\begin{fakt}
Jeœli $n$ jest nieparzyst¹ liczb¹ z³o¿on¹, to jest silnie pseudopierwsza przy podstawie $b$ dla co najwy¿ej $25\%$ wszystkich podstaw $b$ takich, ¿e $0 < b < n$. 
%Dok³adniej, dla n 6= 9 liczba takich podstaw nie przekracza ?(n)/4.
\end{fakt}
Algorytm dzia³ania testu pierwszoœci Millera-Rabina przebiega nastêpuj¹co:
\begin{enumerate}
\item Obliczamy $n-1=2^{s} \cdot t$, gdzie $t$ jest liczb¹ nieparzyst¹.
\item Losujemy $b \in \{2,...,n-2\}$.
\item Obliczamy $a = b^{t}$ mod $n$. Jeœli $a=\pm 1$, to $n$ mo¿e byæ pierwsza.
\item Obliczamy $a = b^{2^{r}t}$ (mod $n$) dla $0 < r < s$. Jeœli dla pewnego $r$ otrzymamy $a = -1$, to $n$ mo¿e byæ pierwsza, w przeciwnym razie $n$ jest z³o¿ona.
\end{enumerate}
Po otrzymaniu odpowiedzi "$n$ jest pierwsza" powtarzamy kroki algorytmu 2-4. 

Skrypt testu pierwszoœci Millera-Rabina przedstawiony zosta³ poni¿ej.

\begin{center}
\lstinputlisting[frame=single]{TestMilleraRabina.m}
\end{center}

Tabela \ref{tabelaMR} przedstawia wyniki otrzymane za pomoc¹ powy¿szego algorytmu i czas dzia³ania funkcji dla ka¿dej operacji.

\begin{table}[H] 
\begin{center}
\begin{tabular}{|r|c|c|c|}
\hline
Lp. & Liczba $n$ & Wynik & Czas dzia³ania funkcji $[s]$ \\ [0.2ex] 
\hline \hline

1 & $5$ & pierwsza & $0.036212$ \\
\hline

2 & $47$ & pierwsza & $0.036644$ \\
\hline

3 & $199$ & pierwsza & $0.038669$\\
\hline

4 & $1999$ & pierwsza & $0.037960$ \\
\hline

5 & $6899$ & pierwsza & $0.037959$\\
\hline

6 & $94427$ & pierwsza & $0.040197$ \\
\hline

7 & $94428$ & z³o¿ona & $0.018025$\\
\hline

8 & $15472145$ & z³o¿ona & $0.049525$\\
\hline

9 & $15472147$ & pierwsza & $0.035766$\\
\hline

10 & $15485857$ & pierwsza & $0.045164$\\
\hline

\end{tabular}
\caption{Wyniki dzia³ania testu pierwszoœci Millera-Rabina dla liczb o ró¿nej wielkoœci.}
\label{tabelaMR}
\end{center}
\end{table}

\section{Chiñski test pierwszoœci}
\section{Test pierwszoœci APR}
\section{Test pierwszoœci ECPP}
\section{Test Lucasa-Lehmera}

\chapter{Zastosowania w kryptografii}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%      B I B L I O G R A F I A
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{9}

\bibitem{karbowski} M. Karbowski, \textit{Podstawy kryptografii}, Helion, Gliwice, (2006).
\bibitem{marzant} W. Marzantowicz, P. Zarzycki, \textit{Elementarna teoria liczb}, Wydawnictwo Naukowe PWN, Warszawa, (2006).
\bibitem{zakrzew} M. Zakrzewski, \textit{Teoria liczb}, Wydanie I. Oficyna Wydawnicza GiS, Wroc³aw, (2017).
\bibitem{sitoAtkina} \url{https://en.wikipedia.org/wiki/Sieve_of_Atkin}
\bibitem{lpb} \url{https://pl.wikipedia.org/wiki/Liczby_bli%C5%BAniacze}
\bibitem{liczbaCarm} \url{https://pl.wikipedia.org/wiki/Liczby_Carmichaela}
\bibitem{gimps} \url{https://www.mersenne.org/primes/}
\bibitem{spiralaulama} \url{https://en.wikipedia.org/wiki/Ulam_spiral}
\bibitem{aks} \url{https://www.cse.iitk.ac.in/users/manindra/algebra/primality_v6.pdf}
\bibitem{multord} \url{https://en.wikipedia.org/wiki/Multiplicative_order}
\end{thebibliography}
\end{document}
